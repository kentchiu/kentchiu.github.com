
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Kent's Blog</title>
  <meta name="author" content="Kent">

  
  <meta name="description" content="pear command install package 自網路安裝某一個pear程式庫： 　　pear install packagename 下載 packages 但不安裝： 　　pear download packagename 　　pear download-all &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://blog.kent-chiu.com/blog/page/12">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="Kent's Blog" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/lib/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-39152849-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">Kent's Blog</a></h1>
  
    <h2>Kent的學習筆記</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:blog.kent-chiu.com" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2011/10/17/pear_101/">PEAR 101</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2011-10-17T00:00:00+08:00" pubdate data-updated="true">Oct 17<span>th</span>, 2011</time>
        
         | <a href="/blog/2011/10/17/pear_101/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><h2>pear command</h2>

<h4>install package</h4>

<p>自網路安裝某一個pear程式庫：</p>

<p>　　pear install packagename</p>

<p>下載 packages 但不安裝：</p>

<p>　　pear download packagename 　　pear download-all</p>

<p>安裝已下載的package：</p>

<p>　　pear install filename.tgz</p>

<h4>listing package</h4>

<p>目前pear網站上所有可取得pear程式庫列表：</p>

<p>　　pear remote-list</p>

<p>列出已安裝package：</p>

<p>　　pear list</p>

<p>列出可以升級的package：</p>

<p>　　pear list-upgrades</p>

<h4>upgrade</h4>

<p>更新package：</p>

<p>　　pear upgrade packagename 　　pear upgrade-all</p>

<h4>remove</h4>

<p>刪除已安裝的package：</p>

<p>　　pear uninstall packagename</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2011/10/17/pdo/">PHP Data Object (PDO)</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2011-10-17T00:00:00+08:00" pubdate data-updated="true">Oct 17<span>th</span>, 2011</time>
        
         | <a href="/blog/2011/10/17/pdo/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><h2>What can it do?</h2>

<ul>
<li>Prepare/execute, bound parameters</li>
<li>Transactions</li>
<li>LOBS</li>
<li>SQLSTATE standard error codes, flexible error handling</li>
<li>Portability attributes to smooth over database specific nuances</li>
</ul>


<h2>Connecting</h2>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>try {
</span><span class='line'>$dbh = new PDO($dsn, $user,
</span><span class='line'>               $password, $options);
</span><span class='line'>} catch (PDOException $e) {
</span><span class='line'>die("Failed to connect:" .
</span><span class='line'>    $e-&gt;getMessage();
</span><span class='line'>}</span></code></pre></td></tr></table></div></figure>


<h2>DSNs</h2>

<ul>
<li>mysql:host=name;dbname=dbname</li>
<li>pgsql:host=name dbname=dbname</li>
<li>odbc:odbc_dsn</li>
<li>oci:dbname=dbname;charset=charset</li>
<li>sqlite:/path/to/file</li>
</ul>


<h2>Connection Management</h2>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>try {
</span><span class='line'>$dbh = new PDO($dsn, $user, $pw);
</span><span class='line'>// use the database here
</span><span class='line'>// ...
</span><span class='line'>// done; release
</span><span class='line'>$dbh = null;
</span><span class='line'>} catch (PDOException $e) {
</span><span class='line'>die($e-&gt;getMessage();
</span><span class='line'>}</span></code></pre></td></tr></table></div></figure>


<h2>Error Handling</h2>

<ul>
<li><p>Maps error codes to ANSI SQLSTATE (5 character text string)</p>

<ul>
<li>also provides the native db error information</li>
</ul>
</li>
<li><p>Three error handling strategies</p>

<ul>
<li>silent (default)</li>
<li>warning</li>
<li>exception</li>
</ul>
</li>
</ul>


<h3>PDO::ERRMODE_SILENT</h3>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>// The default mode
</span><span class='line'>if (!dbh-&gt;query($sql)) {
</span><span class='line'>  echo $dbh-&gt;errorCode(), "&lt;br&gt;";
</span><span class='line'>  $info = $dbh-&gt;errorInfo();
</span><span class='line'>  // $info[0] == $dbh-&gt;errorCode()
</span><span class='line'>  //             SQLSTATE error code
</span><span class='line'>  // $info[1] is driver specific err code
</span><span class='line'>  // $info[2] is driver specific
</span><span class='line'>  //             error message
</span><span class='line'>}</span></code></pre></td></tr></table></div></figure>


<h3>PDO::ERRMODE_WARNING</h3>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$dbh-&gt;setAttribute(PDO::ATTR_ERRMODE,
</span><span class='line'>                   PDO::ERRMODE_WARNING);</span></code></pre></td></tr></table></div></figure>


<ul>
<li>Behaves the same as silent mode</li>
<li>Raises an E_WARNING as errors are detected</li>
<li>Can suppress with @ operator as usual</li>
</ul>


<h3>PDO::ERRMODE_EXCEPTION</h3>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$dbh-&gt;setAttribute(PDO::ATTR_ERRMODE,
</span><span class='line'>                   PDO::ERRMODE_EXCEPTION);
</span><span class='line'>try {
</span><span class='line'>  $dbh-&gt;exec($sql);
</span><span class='line'>} catch (PDOException $e) {
</span><span class='line'>  // display warning message
</span><span class='line'>  print $e-&gt;getMessage();
</span><span class='line'>  $info = $e-&gt;errorInfo;
</span><span class='line'>  // $info[0] == $e-&gt;code
</span><span class='line'>  //             SQLSTATE error code
</span><span class='line'>  // $info[1] driver specific error code
</span><span class='line'>  // $info[2] driver specific error string
</span><span class='line'>}</span></code></pre></td></tr></table></div></figure>


<h2>Get Data</h2>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$dbh = new PDO($dsn);
</span><span class='line'>$stmt = $dbh-&gt;prepare(
</span><span class='line'>                 "SELECT * FROM FOO");
</span><span class='line'>$stmt-&gt;execute();
</span><span class='line'>while ($row = $stmt-&gt;fetch()) {
</span><span class='line'>  print_r($row);
</span><span class='line'>}
</span><span class='line'>$stmt = null;</span></code></pre></td></tr></table></div></figure>


<h2>Forward-only cursors</h2>

<ul>
<li>a.k.a. “unbuffered” queries in mysql parlance</li>
<li>They are the default cursor type</li>
<li>rowCount() doesn&#8217;t have meaning</li>
<li>FAST!</li>
<li>Other queries are likely to block</li>
<li>You must fetch all remaining data before launching another query</li>
<li>\$stmt→closeCursor();</li>
</ul>


<h2>Buffered Queries</h2>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$dbh = new PDO($dsn);
</span><span class='line'>$stmt = $dbh-&gt;query("SELECT * FROM FOO");
</span><span class='line'>$rows = $stmt-&gt;fetchAll();
</span><span class='line'>$count = count($rows);
</span><span class='line'>foreach ($rows as $row) {
</span><span class='line'>  print_r($row);
</span><span class='line'>}</span></code></pre></td></tr></table></div></figure>


<h2>Fetch modes</h2>

<ul>
<li><p>\$stmt→fetch(PDO::FETCH_BOTH);</p>

<ol>
<li>Array with numeric and string keys</li>
<li>default option</li>
</ol>
</li>
<li><p>PDO::FETCH_NUM</p>

<ol>
<li>numeric keys only</li>
</ol>
</li>
<li><p>PDO::FETCH_ASSOC</p>

<ol>
<li>string keys only</li>
</ol>
</li>
<li><p>PDO::FETCH_OBJ</p>

<ol>
<li>stdClass object</li>
<li>\$obj→name == &#8216;name&#8217; column</li>
</ol>
</li>
<li><p>PDO::FETCH_CLASS</p>

<ol>
<li>You choose the class</li>
</ol>
</li>
<li><p>PDO::FETCH_INTO</p>

<ol>
<li>You provide the object</li>
</ol>
</li>
<li><p>PDO::FETCH_COLUMN</p>

<ol>
<li>Fetches a column (example later)</li>
</ol>
</li>
<li><p>PDO::FETCH_BOUND</p>

<ol>
<li>Only fetches into bound variables</li>
</ol>
</li>
<li><p>PDO::FETCH_FUNC</p>

<ol>
<li>Returns the result filtered through a callback</li>
</ol>
</li>
<li><p>see the manual for more</p></li>
</ul>


<h2>Iterators</h2>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$dbh = new PDO($dsn);
</span><span class='line'>$stmt = $dbh-&gt;query(
</span><span class='line'>           "SELECT name FROM FOO",
</span><span class='line'>           PDO::FETCH_COLUMN, 0);
</span><span class='line'>foreach ($stmt as $name) {
</span><span class='line'>  echo "Name: $name\n";
</span><span class='line'>}
</span><span class='line'>$stmt = null;</span></code></pre></td></tr></table></div></figure>


<h2>Changing data</h2>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$deleted = $dbh-&gt;exec( "DELETE FROM FOO WHERE 1");
</span><span class='line'>$changes = $dbh-&gt;exec(
</span><span class='line'>  "UPDATE FOO SET active=1 "
</span><span class='line'> ."WHERE NAME LIKE '%joe%'");</span></code></pre></td></tr></table></div></figure>


<h2>Autonumber/sequences</h2>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$dbh-&gt;exec( "insert into foo values (...)");
</span><span class='line'>echo $dbh-&gt;lastInsertId();
</span><span class='line'>$dbh-&gt;exec( "insert into foo values (...)");
</span><span class='line'>echo $dbh-&gt;lastInsertId("seqname");</span></code></pre></td></tr></table></div></figure>


<p>Its up to you to call the right one for your db!</p>

<h2>Prepared Statements</h2>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>// No need to manually quote data here
</span><span class='line'>$stmt = $dbh-&gt;prepare(
</span><span class='line'>   "INSERT INTO CREDITS (extension, name)"
</span><span class='line'>  ."VALUES (:extension, :name)");
</span><span class='line'>$stmt-&gt;execute(array(
</span><span class='line'>   'extension' =&gt; 'xdebug',
</span><span class='line'>   'name'      =&gt; 'Derick Rethans'
</span><span class='line'>));</span></code></pre></td></tr></table></div></figure>


<h2>Prepared Statements</h2>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>// No need to manually quote data here
</span><span class='line'>$stmt = $dbh-&gt;prepare(
</span><span class='line'>   "INSERT INTO CREDITS (extension, name)"
</span><span class='line'>  ."VALUES (?, ?)");
</span><span class='line'>$stmt-&gt;execute(array(
</span><span class='line'>                  'xdebug',
</span><span class='line'>                  'Derick Rethans'
</span><span class='line'>));</span></code></pre></td></tr></table></div></figure>


<h2>\$db->quote()</h2>

<ul>
<li>If you really must quote things “by-hand”</li>
<li>\$db→quote() adds quotes and proper escaping as needed</li>
<li>But doesn&#8217;t do anything in the ODBC driver!</li>
<li>Best to use prepared statements</li>
</ul>


<h2>Transactions</h2>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$dbh-&gt;beginTransaction();
</span><span class='line'>try {
</span><span class='line'>  $dbh-&gt;query("UPDATE ...");
</span><span class='line'>  $dbh-&gt;query("UPDATE ...");
</span><span class='line'>  $dbh-&gt;commit();
</span><span class='line'>} catch (PDOException $e) {
</span><span class='line'>  $dbh-&gt;rollBack();
</span><span class='line'>}</span></code></pre></td></tr></table></div></figure>


<h2>Stored Procedures</h2>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$stmt = $dbh-&gt;prepare( "CALL sp_set_string(?)");
</span><span class='line'>$stmt-&gt;execute(array('foo'));
</span><span class='line'>$stmt = $dbh-&gt;prepare( "CALL sp_set_string(?)");
</span><span class='line'>$stmt-&gt;bindValue(1, 'foo');
</span><span class='line'>$stmt-&gt;execute();</span></code></pre></td></tr></table></div></figure>


<h2>OUT parameters</h2>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$stmt = $dbh-&gt;prepare( "CALL sp_get_string(?)");
</span><span class='line'>$stmt-&gt;bindParam(1, $ret, PDO::PARAM_STR, 4000);
</span><span class='line'>if ($stmt-&gt;execute()) {
</span><span class='line'>  echo "Got $ret\n";
</span><span class='line'>}</span></code></pre></td></tr></table></div></figure>


<h2>IN/OUT parameters</h2>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$stmt = $dbh-&gt;prepare(
</span><span class='line'>           "call @sp_inout(?)");
</span><span class='line'>$val = "My input data";
</span><span class='line'>$stmt-&gt;bindParam(1, $val,
</span><span class='line'>                 PDO::PARAM_STR|
</span><span class='line'>                 PDO::PARAM_INPUT_OUTPUT,
</span><span class='line'>                 4000);
</span><span class='line'>if ($stmt-&gt;execute()) {
</span><span class='line'>  echo "Got $val\n";
</span><span class='line'>}</span></code></pre></td></tr></table></div></figure>


<h2>Multi-rowset queries</h2>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$stmt = $dbh-&gt;query("call sp_multi_results()");
</span><span class='line'>do {
</span><span class='line'>  while ($row = $stmt-&gt;fetch()) {
</span><span class='line'>    print_r($row);
</span><span class='line'>  }
</span><span class='line'>} while ($stmt-&gt;nextRowset());</span></code></pre></td></tr></table></div></figure>


<h2>Binding columns</h2>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$stmt = $dbh-&gt;prepare(
</span><span class='line'>   "SELECT extension, name from CREDITS");
</span><span class='line'>if ($stmt-&gt;execute()) {
</span><span class='line'>  $stmt-&gt;bindColumn('extension', $ext);
</span><span class='line'>  $stmt-&gt;bindColumn('name', $name);
</span><span class='line'>  while ($stmt-&gt;fetch(PDO::FETCH_BOUND)) {
</span><span class='line'>    echo "Extension: $ext\n";
</span><span class='line'>    echo "Author:    $name\n";
</span><span class='line'>  }
</span><span class='line'>}</span></code></pre></td></tr></table></div></figure>


<h2>Oracle style NULLs</h2>

<ul>
<li><p>Oracle translates empty strings into NULLs</p>

<ul>
<li>\$dbh→setAttribute(PDO::ATTR_ORACLE_NULLS, true)</li>
</ul>
</li>
<li><p>Translates empty strings into NULLs when fetching data</p></li>
<li>But won&#8217;t change them on insert</li>
</ul>


<h2>LOBs</h2>

<ul>
<li>Large objects are usually >4kb in size</li>
<li>Nice to avoid fetching them until you need them</li>
<li>Mature RDBMS offer LOB APIs for this</li>
<li>PDO exposes LOBs as Streams</li>
</ul>


<h2>Fetching an image</h2>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$stmt = $dbh-&gt;prepare(
</span><span class='line'>   "select contenttype, imagedata"
</span><span class='line'>  ." from images where id=?");
</span><span class='line'>$stmt-&gt;execute(array($_GET['id']));
</span><span class='line'>$stmt-&gt;bindColumn(1, $type,
</span><span class='line'>                  PDO::PARAM_STR, 256);
</span><span class='line'>$stmt-&gt;bindColumn(2, $lob,
</span><span class='line'>                  PDO::PARAM_LOB);
</span><span class='line'>$stmt-&gt;fetch(PDO::FETCH_BOUND);
</span><span class='line'>header("Content-Type: $type");
</span><span class='line'>fpassthru($lob);</span></code></pre></td></tr></table></div></figure>


<h2>Uploading an image</h2>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$stmt = $db-&gt;prepare("insert into images "
</span><span class='line'>   . "(id, contenttype, imagedata)"
</span><span class='line'>   . " values (?,?,?)");
</span><span class='line'>$id = get_new_id();
</span><span class='line'>$fp = fopen($_FILES['file']['tmp_name'],'rb');
</span><span class='line'>$stmt-&gt;bindParam(1, $id);
</span><span class='line'>$stmt-&gt;bindParam(2, $_FILES['file']['type']);
</span><span class='line'>$stmt-&gt;bindParam(3, $fp, PDO::PARAM_LOB);
</span><span class='line'>$stmt-&gt;execute();</span></code></pre></td></tr></table></div></figure>


<h2>Scrollable Cursors</h2>

<ul>
<li>Allow random access to a rowset</li>
<li>Higher resource usage than forward-only cursors</li>
<li>Can be used for positioned updates (more useful for CLI/GUI apps)</li>
</ul>


<h2>Positioned updates</h2>

<ul>
<li>An open (scrollable) cursor can be used to target a row for another
query</li>
<li>Name your cursor by setting PDO::ATTR_CURSOR_NAME during prepare()</li>
<li>UPDATE foo set bar = ? WHERE CURRENT OF cursor_name</li>
</ul>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2011/10/17/payment_plugin_demo/">顺风速运货到付款插件</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2011-10-17T00:00:00+08:00" pubdate data-updated="true">Oct 17<span>th</span>, 2011</time>
        
         | <a href="/blog/2011/10/17/payment_plugin_demo/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><h2>安裝</h2>

<ul>
<li>把文件夹上传到网站的根目录(覆盖) -
到后台配送方式－选择货到付款－安装－设置区域和货到付款的费率</li>
</ul>


<p>OK，只需两步即可搞定，此插件是基于顺风速运货到付款</p>

<h2>目錄結構</h2>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>includes
</span><span class='line'>|- modules
</span><span class='line'>    |- shopping
</span><span class='line'>       |- express_cod.php
</span><span class='line'>
</span><span class='line'>languages
</span><span class='line'>|- zh-cn
</span><span class='line'>   |- shopping
</span><span class='line'>      |- express_cod.php</span></code></pre></td></tr></table></div></figure>


<h2>主程式</h2>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
<span class='line-number'>66</span>
<span class='line-number'>67</span>
<span class='line-number'>68</span>
<span class='line-number'>69</span>
<span class='line-number'>70</span>
<span class='line-number'>71</span>
<span class='line-number'>72</span>
<span class='line-number'>73</span>
<span class='line-number'>74</span>
<span class='line-number'>75</span>
<span class='line-number'>76</span>
<span class='line-number'>77</span>
<span class='line-number'>78</span>
<span class='line-number'>79</span>
<span class='line-number'>80</span>
<span class='line-number'>81</span>
<span class='line-number'>82</span>
<span class='line-number'>83</span>
<span class='line-number'>84</span>
<span class='line-number'>85</span>
<span class='line-number'>86</span>
<span class='line-number'>87</span>
<span class='line-number'>88</span>
<span class='line-number'>89</span>
<span class='line-number'>90</span>
<span class='line-number'>91</span>
<span class='line-number'>92</span>
<span class='line-number'>93</span>
<span class='line-number'>94</span>
<span class='line-number'>95</span>
<span class='line-number'>96</span>
<span class='line-number'>97</span>
<span class='line-number'>98</span>
<span class='line-number'>99</span>
<span class='line-number'>100</span>
<span class='line-number'>101</span>
<span class='line-number'>102</span>
<span class='line-number'>103</span>
<span class='line-number'>104</span>
<span class='line-number'>105</span>
<span class='line-number'>106</span>
<span class='line-number'>107</span>
<span class='line-number'>108</span>
<span class='line-number'>109</span>
<span class='line-number'>110</span>
<span class='line-number'>111</span>
<span class='line-number'>112</span>
<span class='line-number'>113</span>
<span class='line-number'>114</span>
<span class='line-number'>115</span>
<span class='line-number'>116</span>
<span class='line-number'>117</span>
<span class='line-number'>118</span>
<span class='line-number'>119</span>
<span class='line-number'>120</span>
<span class='line-number'>121</span>
<span class='line-number'>122</span>
<span class='line-number'>123</span>
<span class='line-number'>124</span>
<span class='line-number'>125</span>
<span class='line-number'>126</span>
<span class='line-number'>127</span>
<span class='line-number'>128</span>
<span class='line-number'>129</span>
<span class='line-number'>130</span>
<span class='line-number'>131</span>
<span class='line-number'>132</span>
<span class='line-number'>133</span>
<span class='line-number'>134</span>
<span class='line-number'>135</span>
<span class='line-number'>136</span>
<span class='line-number'>137</span>
<span class='line-number'>138</span>
<span class='line-number'>139</span>
<span class='line-number'>140</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>&lt;?php
</span><span class='line'> 
</span><span class='line'>/**
</span><span class='line'> * ECSHOP 顺丰速运货到付款 配送方式插件
</span><span class='line'> * ============================================================================
</span><span class='line'> * 版权所有 (C) 2005-2008 康盛创想（北京）科技有限公司，并保留所有权利。
</span><span class='line'> * 网站地址: http://www.ecshop.com；http://www.comsenz.com
</span><span class='line'> * ----------------------------------------------------------------------------
</span><span class='line'> * 这不是一个自由软件！您只能在不用于商业目的的前提下对程序代码进行修改和
</span><span class='line'> * 使用；不允许对程序代码以任何形式任何目的的再发布。
</span><span class='line'> * ============================================================================
</span><span class='line'> * $Author: testyang $
</span><span class='line'> * $Id: express_cod.php 14481 2008-04-18 11:23:01Z testyang $
</span><span class='line'> */
</span><span class='line'> 
</span><span class='line'>if (!defined('IN_ECS'))
</span><span class='line'>{
</span><span class='line'>    die('Hacking attempt');
</span><span class='line'>}
</span><span class='line'> 
</span><span class='line'>$shipping_lang = ROOT_PATH.'languages/' .$GLOBALS['_CFG']['lang']. '/shipping/express_cod.php';
</span><span class='line'> 
</span><span class='line'>if (file_exists($shipping_lang))
</span><span class='line'>{
</span><span class='line'>    global $_LANG;
</span><span class='line'>    include_once($shipping_lang);
</span><span class='line'>}
</span><span class='line'> 
</span><span class='line'>/* 模块的基本信息 */
</span><span class='line'>if (isset($set_modules) && $set_modules == TRUE)
</span><span class='line'>{
</span><span class='line'>    $i = (isset($modules)) ? count($modules) : 0;
</span><span class='line'> 
</span><span class='line'>    /* 配送方式插件的代码必须和文件名保持一致 */
</span><span class='line'>    $modules[$i]['code']    = basename(__FILE__, '.php');
</span><span class='line'> 
</span><span class='line'>    $modules[$i]['version'] = '1.0.0';
</span><span class='line'> 
</span><span class='line'>    /* 配送方式的描述 */
</span><span class='line'>    $modules[$i]['desc']    = 'express_desc';
</span><span class='line'> 
</span><span class='line'>    /* 配送方式是否支持货到付款 */
</span><span class='line'>    $modules[$i]['cod']     = TRUE;
</span><span class='line'> 
</span><span class='line'>    /* 插件的作者 */
</span><span class='line'>    $modules[$i]['author']  = '好车饰';
</span><span class='line'> 
</span><span class='line'>    /* 插件作者的官方网站 */
</span><span class='line'>    $modules[$i]['website'] = 'http://www.carhao.com';
</span><span class='line'> 
</span><span class='line'>    /* 配送接口需要的参数 */
</span><span class='line'>    $modules[$i]['configure'] = array(
</span><span class='line'>                                    array('name' =&gt; 'basic_fee',    'value'=&gt;15), /* 1000克以内的价格           */
</span><span class='line'>                                    array('name' =&gt; 'step_fee',     'value'=&gt;2),  /* 续重每1000克增加的价格 */
</span><span class='line'>                                );
</span><span class='line'> 
</span><span class='line'>    return;
</span><span class='line'>}
</span><span class='line'> 
</span><span class='line'>/**
</span><span class='line'> * 顺丰速运费用计算方式: 起点到终点 * 重量(kg)
</span><span class='line'> * ====================================================================================
</span><span class='line'> * -浙江，上海，江苏地区为15元/公斤，续重(2元/公斤)
</span><span class='line'> * -续重每500克或其零数 (具体请上顺丰速运网站查询:http://www.sf-express.com/sfwebapp/price.jsp 客服电话 4008111111)
</span><span class='line'> *
</span><span class='line'> * -------------------------------------------------------------------------------------
</span><span class='line'> */
</span><span class='line'> 
</span><span class='line'>class express_cod
</span><span class='line'>{
</span><span class='line'>    /*------------------------------------------------------ */
</span><span class='line'>    //-- PUBLIC ATTRIBUTEs
</span><span class='line'>    /*------------------------------------------------------ */
</span><span class='line'> 
</span><span class='line'>    /**
</span><span class='line'>     * 配置信息参数
</span><span class='line'>     */
</span><span class='line'>    var $configure;
</span><span class='line'> 
</span><span class='line'>    /*------------------------------------------------------ */
</span><span class='line'>    //-- PUBLIC METHODs
</span><span class='line'>    /*------------------------------------------------------ */
</span><span class='line'> 
</span><span class='line'>    /**
</span><span class='line'>     * 构造函数
</span><span class='line'>     *
</span><span class='line'>     * @param: $configure[array]    配送方式的参数的数组
</span><span class='line'>     *
</span><span class='line'>     * @return null
</span><span class='line'>     */
</span><span class='line'>    function express_cod($cfg=array())
</span><span class='line'>    {
</span><span class='line'>        foreach ($cfg AS $key=&gt;$val)
</span><span class='line'>        {
</span><span class='line'>            $this-&gt;configure[$val['name']] = $val['value'];
</span><span class='line'>        }
</span><span class='line'> 
</span><span class='line'>    }
</span><span class='line'> 
</span><span class='line'>    /**
</span><span class='line'>     * 计算订单的配送费用的函数
</span><span class='line'>     *
</span><span class='line'>     * @param   float   $goods_weight   商品重量
</span><span class='line'>     * @param   float   $goods_amount   商品金额
</span><span class='line'>     * @return  decimal
</span><span class='line'>     */
</span><span class='line'>    function calculate($goods_weight, $goods_amount)
</span><span class='line'>    {
</span><span class='line'>        if ($this-&gt;configure['free_money'] &gt; 0 && $goods_amount &gt;= $this-&gt;configure['free_money'])
</span><span class='line'>        {
</span><span class='line'>            return 0;
</span><span class='line'>        }
</span><span class='line'>        else
</span><span class='line'>        {
</span><span class='line'>            @$fee = $this-&gt;configure['basic_fee'];
</span><span class='line'> 
</span><span class='line'>            if ($goods_weight &gt; 1)
</span><span class='line'>            {
</span><span class='line'>                $fee += (ceil(($goods_weight - 1))) * $this-&gt;configure['step_fee'];
</span><span class='line'>            }
</span><span class='line'>           // $_SESSION['cart_weight'] = $goods_weight;
</span><span class='line'>            return $fee;
</span><span class='line'>        }
</span><span class='line'>    }
</span><span class='line'> 
</span><span class='line'>    /**
</span><span class='line'>     * 查询快递状态
</span><span class='line'>     *
</span><span class='line'>     * @access  public
</span><span class='line'>     * @return  string  查询窗口的链接地址
</span><span class='line'>     */
</span><span class='line'>    function query($invoice_sn)
</span><span class='line'>    {
</span><span class='line'>        $form_str = '&lt;a href="http://www.sf-express.com/sfwebapp/track.jsp?tracklist='.$invoice_sn.'" target="_blank"&gt;' .$invoice_sn. '&lt;/a&gt;';
</span><span class='line'> 
</span><span class='line'>        return $form_str;
</span><span class='line'>    }
</span><span class='line'>}
</span><span class='line'> 
</span><span class='line'>?&gt;</span></code></pre></td></tr></table></div></figure>


<h2>語系程式</h2>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>&lt;?php
</span><span class='line'> 
</span><span class='line'>/**
</span><span class='line'> * ECSHOP 顺丰速运货到付款插件的语言文件
</span><span class='line'> * ============================================================================
</span><span class='line'> * 版权所有 (C) 2005-2008 康盛创想（北京）科技有限公司，并保留所有权利。
</span><span class='line'> * 网站地址: http://www.ecshop.com；http://www.comsenz.com
</span><span class='line'> * ----------------------------------------------------------------------------
</span><span class='line'> * 这不是一个自由软件！您只能在不用于商业目的的前提下对程序代码进行修改和
</span><span class='line'> * 使用；不允许对程序代码以任何形式任何目的的再发布。
</span><span class='line'> * ============================================================================
</span><span class='line'> * $Author: testyang $
</span><span class='line'> * $Id: express_cod.php 14481 2008-04-18 11:23:01Z testyang $
</span><span class='line'>*/
</span><span class='line'>global $_LANG;
</span><span class='line'> 
</span><span class='line'>$_LANG['express_cod']            = '货到付款';
</span><span class='line'>$_LANG['express_desc']           = '江、浙、沪地区首重15元/KG，续重2元/KG，其余城市首重20元/KG';
</span><span class='line'>$_LANG['basic_fee']              = '1000克以内费用';
</span><span class='line'>$_LANG['step_fee']               = '续重每1000克或其零数的费用';
</span><span class='line'> 
</span><span class='line'>?&gt;</span></code></pre></td></tr></table></div></figure>



</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2011/10/17/pax_101/">PAX 101</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2011-10-17T00:00:00+08:00" pubdate data-updated="true">Oct 17<span>th</span>, 2011</time>
        
         | <a href="/blog/2011/10/17/pax_101/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><h1>Quick Satrt</h1>

<ul>
<li>download <a href="http://www.ops4j.org/projects/pax/construct/index.html" title="http://www.ops4j.org/projects/pax/construct/index.html">pax
construct</a></li>
<li>setup path</li>
<li>create a new OSGi project <code>pax-create-project -g examples -a test</code></li>
<li>create a Bundle
<code>pax-create-bundle -p org.example.pkg -n test.bundle</code></li>
<li>build and deploy <code>mvn clean install pax:provision</code></li>
<li>shutdown felix server by <code>shutdown</code> commend</li>
</ul>


<h1>setup your own env</h1>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>  &lt;plugin&gt;
</span><span class='line'>    &lt;groupId&gt;org.ops4j&lt;/groupId&gt;
</span><span class='line'>    &lt;artifactId&gt;maven-pax-plugin&lt;/artifactId&gt;
</span><span class='line'>    &lt;version&gt;1.4&lt;/version&gt;
</span><span class='line'>    &lt;configuration&gt;
</span><span class='line'>      &lt;!--
</span><span class='line'>       | some example Pax-Runner settings
</span><span class='line'>      --&gt;
</span><span class='line'>      &lt;provision&gt;
</span><span class='line'>        &lt;param&gt;--platform=felix&lt;/param&gt;
</span><span class='line'>      &lt;/provision&gt;
</span><span class='line'>    &lt;/configuration&gt;
</span><span class='line'>    &lt;executions&gt;
</span><span class='line'>      &lt;!--
</span><span class='line'>       | uncomment to auto-generate IDE files
</span><span class='line'>      &lt;execution&gt;
</span><span class='line'>        &lt;id&gt;ide-support&lt;/id&gt;
</span><span class='line'>        &lt;goals&gt;
</span><span class='line'>          &lt;goal&gt;eclipse&lt;/goal&gt;
</span><span class='line'>        &lt;/goals&gt;
</span><span class='line'>      &lt;/execution&gt;
</span><span class='line'>      --&gt;
</span><span class='line'>    &lt;/executions&gt;
</span><span class='line'>  &lt;/plugin&gt;
</span><span class='line'>  &lt;plugin&gt;
</span><span class='line'>&lt;artifactId&gt;maven-compiler-plugin&lt;/artifactId&gt;
</span><span class='line'>&lt;configuration&gt;
</span><span class='line'>  &lt;source&gt;1.5&lt;/source&gt;
</span><span class='line'>  &lt;target&gt;1.5&lt;/target&gt;
</span><span class='line'>  &lt;encoding&gt;UTF-8&lt;/encoding&gt;
</span><span class='line'>&lt;/configuration&gt;
</span><span class='line'>  &lt;/plugin&gt;      </span></code></pre></td></tr></table></div></figure>


<p>default pom.xml under proejct is like above. You can
<code>&lt;param&gt;–platform=felix&lt;/param&gt;</code> to <code>&lt;param&gt;–platform=equinox&lt;/param&gt;</code>
and enabled ide support by remove comment.</p>

<h1>embed 3th party jar</h1>

<ol>
<li>pax-embed-jar</li>
<li>mvn install</li>
<li>pax-provision</li>
</ol>


<p>embed or wrap</p>

<p>embed: just put jar in container wrap: provides capability for install,
resoled, unstall, update, export package ….</p>

<h1>Enable Spring DM</h1>

<ul>
<li>check
<a href="http://www.ops4j.org/projects/pax/construct/examples/spring-osgi.html" title="http://www.ops4j.org/projects/pax/construct/examples/spring-osgi.html">here</a></li>
</ul>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2011/10/17/orphan_deletion/">幽靈資料(Orphan Data)的處理方式</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2011-10-17T00:00:00+08:00" pubdate data-updated="true">Oct 17<span>th</span>, 2011</time>
        
         | <a href="/blog/2011/10/17/orphan_deletion/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>在實際的系統上，一個模組所使用的資料，常會依賴於所多其他的模組，這些關聯可能會透過新增資料時來建立，
以照片管理應用程式來說，至少會有相片模組及使用者模組，以相片模組來說，新增完一張照片後，通常，相關聯的資料會是</p>

<ol>
<li>或者照片本身的細節資訊(分別存放在多個tables)</li>
<li>這張照片是屬於那個人的(使用者模組的使用者資料)</li>
<li>這個照片被誰引用(別的使用者將這張相片放入自已的相本)</li>
</ol>


<p>以上面的例子來說，第一個是<strong>一對多 +
多對一</strong>的Master-Details關係，第二個是透過在相片主table放一個user_id的Forgin
Key的<strong>多對一</strong>，第三個是一張相片可能被多人引用，也可能一個人引用多張相片的<strong>多對多</strong>的關係。
在大多數的應用上，通常，
第一點的照片本身及細節的table，因為跟相片本身有比較大的相關性，所以，通常會放在相片模組裡面，刪除時，通常會一併處理，
第二點因為相片是透過存forgin
key，如果只是刪除相片本身，通常沒什麼問題，但如果<strong>刪除使用者時是否需一併刪除相關的相片</strong>，這就是本文要討論的重點。
第三點，設計時，是否會放在相片的module，與是否一併刪除，就看設計者的考量。</p>

<p>正常的設計上，刪除使用者，一併刪除所有相關的資料，這樣不會造成幽靈資料(Orphan
data)，但如果與使用者相關的模組的變多，變複雜，那刪除一個使用者，要一併刪除底下一大串的相關資料，這樣容易會造成刪除的動作失敗。</p>

<p>目前想得到，最佳的solution是<strong>只刪除最直接相關的資料，其他間接相關的資料不進行刪除</strong>，這樣最大的好處是簡化設計，但可能需提供一個清除這樣幽靈資料的功能或sql
script。目前關於這個做法相關的議題如下：</p>

<blockquote><p>幽靈資料(Orphan data)會造成資料庫的負擔</p>

<blockquote><p>基本上，這個問題不需要太被關注，如果要解決，已經是資料庫效能調校的議題。或者，可透過清除幽靈資料(Orphan
data)的動作進行處理。</p></blockquote>

<p>幽靈資料(Orphan data)是否會造成統計異常，資料不一致</p>

<blockquote><p>如果統計時，都有依據關聯的key做統計，那不存在的FK的資料就不會被計入，就不會照成這個問題</p>

<blockquote><p>如果採原始的刪除方式(刪除所有相關資料)，如果有一筆資料無法刪除，就會發生刪除無法成功(所有刪除動作在同一個transcation)或者資料不一致(刪除的動作不在同一個transcation)</p></blockquote></blockquote></blockquote>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2011/10/17/oracle_101/">Oracle 101</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2011-10-17T00:00:00+08:00" pubdate data-updated="true">Oct 17<span>th</span>, 2011</time>
        
         | <a href="/blog/2011/10/17/oracle_101/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><h4>Schema</h4>

<p>Oracle的資料庫觀念，與MySql,MSSQL並大一樣，，在連入(不管透過工具或jdbc
driver)，都必需使用特定的user name連到特定的Schema
在查詢時，也需指明確的指出查那一個shema</p>

<p>在oracle中，有部份constrain匯入後，有異常，例如說：
function_log這個table中的 constrain，匯入後是</p>

<p>function_log.<strong>logId</strong> → user_info.userId</p>

<p>但應該下面的才是正確的</p>

<p>function_log.<strong>userId</strong>→ user_info.userId</p>

<h4>Auto Increment</h4>

<p>oracle中沒有自動增值(每次insert後，自動產生+1的值給Primary
Key使用)，但還是可以透過sequence達到類似的功能，
惟sequence是須在insert時自行加入Insert
Statement中，而不是Database自動幫我們設定到PK中</p>

<p><a href="http://fanqiang.chinaunix.net/a2/b2/20010514/10150052_b.html" title="http://fanqiang.chinaunix.net/a2/b2/20010514/10150052_b.html">這裡</a>有相關的說明</p>

<p>Example: 建立給user info用的sequence</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>CREATE SEQUENCE userinfo_sequence 
</span><span class='line'>    INCREMENT BY 1   
</span><span class='line'>    START WITH 1     
</span><span class='line'>    NOMAXVALUE       
</span><span class='line'>    NOCYCLE          
</span><span class='line'>    CACHE 10;  </span></code></pre></td></tr></table></div></figure>




<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>INSERT INTO SCOTT.USER_INFO (USERID,USERNAME) VALUES(userinfo_sequence.NEXTVAL,'kent')</span></code></pre></td></tr></table></div></figure>


<h5>測試是否有Sequence存取權限</h5>

<p>該使用者要有存取<a href="http://www.adp-gmbh.ch/ora/misc/dual.html" title="http://www.adp-gmbh.ch/ora/misc/dual.html">daul</a>
table的權限。<code>daul</code> table是記錄<code>SEQUENCE</code>的table.
可以透過些語法測試是否有存取<code>daul</code> table的權限</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>select USERINFO_SEQUENCE.NEXTVAL from DUAL</span></code></pre></td></tr></table></div></figure>


<h5>所出所有Sequences</h5>

<p>查詢所有<code>SEQUENCE</code>的語法(需要DBA權限)</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>SELECT * FROM dba_sequences</span></code></pre></td></tr></table></div></figure>


<h4>Driver</h4>

<p>oracle有提供type 4的jdbc driver (ojdbc or
odbc)，每一個資料庫版本適用的driver不太一樣，常見的有這幾種</p>

<p>  jar name       For Oracle   說明</p>

<hr />

<p>  oracle12.jar   ALL          for jdk 1.2
  oracle14.jar   ALL          for jdk 1.4
  oracle5.jar    11g          for jdk 1.5, 我們主要用的driver
  oracle6 .jar   11g          for jdk 1.6</p>

<h4>DataType</h4>

<p>Oracle與SQL Server的資料型別上有些差異，我們有用到的部份，表列如下：</p>

<h4>Null與空字串</h4>

<p>Oracle會把空字串(empty string, length=0)當作是null</p>

<h4>SQL syntax</h4>

<p>TBD</p>

<h4>Commands</h4>

<h5>desc</h5>

<p>顯示table的描述</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>#語法
</span><span class='line'>desc table_name
</span><span class='line'>#範例
</span><span class='line'>desc my_table</span></code></pre></td></tr></table></div></figure>


<h5>list all tables in current schema</h5>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>SELECT table_name FROM user_tables;</span></code></pre></td></tr></table></div></figure>


<h5>list all tables current user</h5>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>SELECT table_name FROM all_tables;
</span><span class='line'> 
</span><span class='line'>SELECT table_name FROM user_tables where owner='SYS';</span></code></pre></td></tr></table></div></figure>


<p>Oracle的字串是區分會小寫，where owner=&#8217;SYS&#8217; 跟where
owner=&#8217;sys&#8217;查到的結果是不一樣的</p>

<h5>list all schemas</h5>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>SELECT username FROM all_users ORDER BY username;</span></code></pre></td></tr></table></div></figure>


<h5>top n records</h5>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>SELECT * FROM table_name where rownum &lt; n;</span></code></pre></td></tr></table></div></figure>



</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2011/10/17/ood_5_principles/">OOD 五大原則</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2011-10-17T00:00:00+08:00" pubdate data-updated="true">Oct 17<span>th</span>, 2011</time>
        
         | <a href="/blog/2011/10/17/ood_5_principles/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><ol>
<li>SRP</li>
<li>OCP</li>
<li>LSP</li>
<li>DIP</li>
<li>ISP</li>
</ol>


<h5>OOD 五大原則 (5 principles)</h5>

<h2>SRP</h2>

<p>Name: The Single Responsibility Principle</p>

<p>Desc: A class should have one, and only one, reason to change.</p>

<h2>OCP</h2>

<p>Name: The Open Closed Principle</p>

<p>Desc: You should be able to extend a classes behavior, without modifying
it.</p>

<h2>LSP</h2>

<p>Name: The Liskov Substitution Principle</p>

<p>Desc: Derived classes must be substitutable for their base classes.</p>

<h2>DIP</h2>

<p>Name: The Dependency Inversion Principle</p>

<p>Desc: Depend on abstractions, not on concretions.</p>

<h2>ISP</h2>

<p>Name: The Interface Segregation Principle</p>

<p>Desc: Make fine grained interfaces that are client specific.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2011/10/17/online_dictionary/">線上字典</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2011-10-17T00:00:00+08:00" pubdate data-updated="true">Oct 17<span>th</span>, 2011</time>
        
         | <a href="/blog/2011/10/17/online_dictionary/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><h3>學習者字典(Learner&#8217;s dictionary)</h3>

<p>learner&#8217;s dictionary用字比較簡單，解釋也比較簡單</p>

<ol>
<li><a href="http://www.ldoceonline.com/" title="http://www.ldoceonline.com/">Longman</a>

<ul>
<li>朗文字典，最常用的 Learner&#8217;s
dictionary，可惜只有s跟d開頭的單字有發音</li>
</ul>
</li>
<li><a href="http://dictionary.cambridge.org/" title="http://dictionary.cambridge.org/">http://dictionary.cambridge.org/</a>

<ul>
<li>康橋字典</li>
</ul>
</li>
<li><a href="http://www.oxfordadvancedlearnersdictionary.com/" title="http://www.oxfordadvancedlearnersdictionary.com/">http://www.oxfordadvancedlearnersdictionary.com/</a>

<ul>
<li>牛津學習者字典</li>
</ul>
</li>
<li><a href="http://www.collinslanguage.com/Default.aspx" title="http://www.collinslanguage.com/Default.aspx">http://www.collinslanguage.com/Default.aspx</a>

<ul>
<li>collins</li>
</ul>
</li>
<li><a href="http://www.learnersdictionary.com/" title="http://www.learnersdictionary.com/">http://www.learnersdictionary.com/</a>

<ul>
<li>韋伯學習者字典</li>
</ul>
</li>
</ol>


<h3>英英字典</h3>

<ol>
<li><h2><a href="http://dictionary.reference.com/" title="http://dictionary.reference.com/">dictionary</a></h2>

<p>最常用的字典，發音速度很快，有<a href="http://dictionary.reference.com/help/luna/Spell_pron_key.html" title="http://dictionary.reference.com/help/luna/Spell_pron_key.html">Spelled</a>跟<a href="http://dictionary.reference.com/help/luna/IPA_pron_key.html" title="http://dictionary.reference.com/help/luna/IPA_pron_key.html">IPA</a>兩種音標</p></li>
<li><a href="http://www.thefreedictionary.com/" title="http://www.thefreedictionary.com/">http://www.thefreedictionary.com/</a>

<ul>
<li>The Free Dictionary</li>
</ul>
</li>
<li><a href="http://oxforddictionaries.com/" title="http://oxforddictionaries.com/">http://oxforddictionaries.com/</a>

<ul>
<li>牛津字典(字典界的權威)</li>
</ul>
</li>
<li><a href="http://www.merriam-webster.com/" title="http://www.merriam-webster.com/">http://www.merriam-webster.com/</a>

<ul>
<li>韋伯字典</li>
</ul>
</li>
<li><a href="http://www.macmillandictionary.com" title="http://www.macmillandictionary.com">麥可米倫</a></li>
<li><a href="http://www.alphadictionary.com/index.shtml" title="http://www.alphadictionary.com/index.shtml">http://www.alphadictionary.com/index.shtml</a>
-這個應該不算線上字典，它是查一個字後，link到多個字典去看細節，算是字典portal吧</li>
</ol>


<h3>字源字典 (Etymology)</h3>

<p>有單字的來源還有字首，字尾，字根說明</p>

<ol>
<li><a href="http://www.etymonline.com/index.php" title="http://www.etymonline.com/index.php">http://www.etymonline.com/index.php</a>

<ul>
<li>最常用的字源字典</li>
</ul>
</li>
<li><a href="http://www.southampton.liunet.edu/academic/pau/course/webesl.htm" title="http://www.southampton.liunet.edu/academic/pau/course/webesl.htm">http://www.southampton.liunet.edu/academic/pau/course/webesl.htm</a>

<ul>
<li>TOEFL用字整理</li>
</ul>
</li>
</ol>


<h3>同義詞典(Thesaurus)</h3>

<p>同義詞典: 找同義字，近義字的差別，用法</p>

<ol>
<li><a href="http://thesaurus.com/" title="http://thesaurus.com/">thesaurus</a></li>
<li><a href="http://www.visualthesaurus.com/" title="http://www.visualthesaurus.com/">http://www.visualthesaurus.com/</a>

<ul>
<li>Visual Thesaurus，用圖像的方式顯示字義的距離</li>
</ul>
</li>
</ol>


<h3>圖片字典</h3>

<p>圖片有時是最佳的說明，而且又可以加強記憶</p>

<ol>
<li><a href="http://www.thefreedictionary.com/" title="http://www.thefreedictionary.com/">http://www.thefreedictionary.com/</a>

<ul>
<li>The Free Dictionary</li>
</ul>
</li>
</ol>


<h3>漢音字典</h3>

<p>真的看了好幾本英英字典的解釋還是看不懂，那就用中英字典吧</p>

<ol>
<li><a href="http://tw.dictionary.yahoo.com/" title="http://tw.dictionary.yahoo.com/">Yahoo奇摩字典</a></li>
<li><a href="http://translate.google.com.tw/" title="http://translate.google.com.tw/">Google翻譯</a></li>
</ol>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2011/10/17/notes/">My English Notes</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2011-10-17T00:00:00+08:00" pubdate data-updated="true">Oct 17<span>th</span>, 2011</time>
        
         | <a href="/blog/2011/10/17/notes/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><h4>auxiliary verb</h4>

<ol>
<li>be</li>
<li>do</li>
<li>have</li>
</ol>


<p>除了這三個，還有所調的modal verb也是屬於auxiliary verb</p>

<h4>Terms</h4>

<p>  九大詞性</p>

<hr />

<p>  noun             名詞
  verb             動詞
  adverb           副詞
  preposition      介系詞
  conjunction      連接詞
  adjective        形容詞
  pronoun          代名詞
  interjection     感嘆詞
  auxiliary verb   助動詞</p>

<hr />

<p>  transitive verb     及物動詞
  intransitive verb   不及物動詞
  modal verb          語氣動詞
  dative verb         授與動詞
  link verb           連綴動詞(be動詞)
  determiner          限定詞^<a href="#fn__1">1)</a>^
  vowel               母音
  consonants          字音
  article             冠詞</p>

<hr />

<h4>model verb</h4>

<p>A modal verb (also modal, modal auxiliary verb, modal auxiliary) is a
type of auxiliary verb that is used to indicate modality.</p>

<ol>
<li>can</li>
<li>cannot</li>
<li>could</li>
<li>dare (敢，竟敢)</li>
<li>may</li>
<li>might</li>
<li>must</li>
<li>ought to = shall</li>
<li>oughta = ought to = shall : a way of saying &#8216;ought to&#8217; - used
especially in writing to show how it is pronounced by some people</li>
<li>shall (使用於第一人稱)</li>
<li>should : should is more strong then shall</li>
<li>used to : 用於之前常發生，但現在確不一定了</li>
<li>will</li>
<li>would : should is more strong then will</li>
</ol>


<h4>so</h4>

<p>so 當Conjunctions用時，解釋成result</p>

<h4>will</h4>

<p>will可以在未來式，也可以當作一個通常會發生的結果(WHAT GENERALLY
HAPPENS)，但這個結果比較像是現在式(頻率，習慣)而不是末來式</p>

<p>&lt;box round | the will explain come from longman dictionary></p>

<p>WHAT GENERALLY HAPPENS</p>

<p>used to say what always happens in a particular situation or what is
generally true</p>

<ul>
<li>Oil will float on water.</li>
<li>Accidents will happen.</li>
</ul>


<p>&lt;/box></p>

<h4>動詞三態區分方式</h4>

<p>過去式和未來式必會伴隨時間副詞如yesterday,tomorrow,last night…
而現在式往往伴隨頻率副詞如always,sometimes,often.</p>

<p>再來就是動詞的狀態,強調動作的進行就是進行式;強調動作持續一段時間則是完成式,兩個都強調那就是完成進行式.其實並不是每個動作都是有這三種狀態,比如說知道know,就不會有knowing進行式,文法上沒有錯但沒人這麼用,因為知道是一種迅速的轉變,快到你看不見進行狀態,不過這要靠長期的閱讀才能慢慢體會與感覺.</p>

<h4>近義字區分方式及使用時機</h4>

<p>歐美研究語義的學者（thesaurist），對同義字（synonym）所下的定義是：idea（概念）相同，但意義、用法略有差別。同義字對學習語言的人來說，實在是件頭疼的事。本書為了解決您對英文同義字的困擾，特別將同義字分成以下三類討論。</p>

<ol>
<li>意義、用法相同，只是有口語化與文言之別。例如”mistake”與”error”；”sick”與”ill”；”big”與”large”等。</li>
<li>自同一idea衍生而來，但是意義不同，因而用法也大異其趣者，例如：”doubt”與”suspect”；”foreign”與”alien”；”substantial”與”substantive”等。</li>
<li>容易被誤為同義字，其實意義迥然不同者。這種錯誤不僅我們容易犯，連英語系國家的人也往往混淆不清，例如”fortunate”與
“happy”（幸福的）；”fault”與”flaw”（缺點）；”local”與”regional”（地方）等等，稍不留意，就容易發生錯誤，難免貽笑大方。</li>
</ol>


<p>同義字也可以透過字根來拆解</p>

<h4>動詞轉成形容詞</h4>

<p>一個句子不能有兩個動詞，所以，如果動詞後面的動詞會變成分詞(現在分詞 or
過去分詞)，當形容詞用，來形容名詞。
形容詞和副詞。形容詞是修飾名詞專用的。副詞則主要用來修飾名詞以外的詞類，包括動詞、形容詞與副詞。</p>

<p>形容詞只能形容名詞，不能形容動詞</p>

<h4>to</h4>

<p>可當介系詞 可當不定詞(不定詞有很多詞性，因為不定詞就是不確定是什麼詞性)</p>

<h1>Dr Lee&#8217;s basic 8 rules</h1>

<ol>
<li>兩個動詞不能連在一起用。</li>
<li>如果一定要用兩個動詞，必須加to，或者是在動詞後面加ing。</li>
<li>如果主詞是第三人稱單數，且時態為現在式，動詞必須加s。</li>
<li>絕大多數的否定句子，不能直接加not。</li>
<li>在不定詞to的後面，必須用原形動詞</li>
<li>英文中有所謂的助動詞，必須注意。</li>
<li>絕大多數的英文問題要有助動詞。</li>
<li>特殊動詞隨主詞而變化。</li>
</ol>


<h2>兩個動詞不能連在一起用</h2>

<h2>如果一定要用兩個動詞，必須加to，或者是在動詞後面加ing</h2>

<p>加to是變成不定詞，在動詞後面加ing則是變成分詞(現在分詞)，而不定詞跟現在分詞(現在分詞片語)都可當形容詞用</p>

<h3>Examples</h3>

<ul>
<li>I love to swing.</li>
<li>I love swing.</li>
<li>I hate to eat fish.</li>
<li>I hate eating fish.</li>
</ul>


<h3>過去分詞?</h3>

<p>為什麼不包含過去分詞?
因為過去分詞要跟Be動詞連用，變成過去分詞片語，當形容詞用。</p>

<h2>如果主詞是第三人稱單數，且時態為現在式，動詞必須加s</h2>

<h2>絕大多數的否定句子，不能直接加not</h2>

<h2>在不定詞to的後面，必須用原形動詞</h2>

<h2>英文中有所謂的助動詞，必須注意</h2>

<h2>絕大多數的英文問題要有助動詞</h2>

<h2>特殊動詞隨主詞而變化</h2>

<h1>過去進行式</h1>

<p>兩件事同時發生在過去要用一個用過去試，一個用<strong>過去進行式</strong>。</p>

<blockquote><p>I am watching TV when she called me.</p></blockquote>

<h1>static verbs</h1>

<p>動詞是「靜態動詞」(static
verbs)、並不代表「動作」，自然也就沒有所謂的「正在做」或「一直做」。因此，以傳統文法的角度來說：靜態動詞不能用於進行式。</p>

<p>static verbs</p>

<h2>5 patterns</h2>

<ol>
<li>S+V</li>
<li>S+V+O</li>
<li>S+V+C</li>
<li>S+V+O+O</li>
<li>S+V+O+C</li>
</ol>


<p>S：主詞，V：動詞，O：受詞，C：補語）</p>

<p>分詞構句會出現不符合上面5個pattern的狀況: ex:</p>

<p>Left home just one week, Mark found himself kind of missing his mother.</p>

<p>這個句子中的left是leave的過去分詞，但過去分詞只能當形容詞不能當名詞用，
所以，直覺上會認為，left是在主詞的位置應該是，要把lefe改成現在分詞當名詞</p>

<p>ex:</p>

<p>Leaving home just one week, Mark found himself kind of missing his
mother.</p>

<p>或用完成式</p>

<p>Having left home just one week, Mark found himself kind of missing his
mother.</p>

<p>但，其實，Left home just one week, Mark found himself kind of missing
his mother. 是 <strong>Being</strong> Left home just one week, Mark found himself
kind of missing his mother.省略掉<strong>Being</strong> , 但省略掉後，會造成不符合5
patterns。所以被叫分詞構句</p>

<h1>TBD</h1>

<ol>
<li>is 後面怎麼接動詞表持續性，但又不當動名詞用</li>
<li>to
不當不定詞用時，如否接原形動詞外的動詞，或根本就接的是其他的詞性(ex:過去分詞)</li>
</ol>


<p>ex: I found a solution <strong>to using</strong> dokuwiki as blog.
這裡表達用using持續的用，而且found表已找到</p>

<ol>
<li>重複字尾+ing的用法，去掉不發音e的用法，去y + ing的用法…</li>
</ol>


<p>^<a href="#fnt__1">1)</a>^ 英文的「限定詞」(determiners)
位在名詞之前，用來「限定」名詞。</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2011/10/17/mysql/">MySQL</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2011-10-17T00:00:00+08:00" pubdate data-updated="true">Oct 17<span>th</span>, 2011</time>
        
         | <a href="/blog/2011/10/17/mysql/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><ul>
<li><a href="http://wiki.kent-chiu.com/doku.php?id=mysql:mysql_101" title="mysql:mysql_101">MySQL
101</a></li>
<li><a href="http://wiki.kent-chiu.com/doku.php?id=mysql:high_performance_mysql_study_notes" title="mysql:high_performance_mysql_study_notes">High Performance MySQL study
notes</a></li>
<li><a href="http://wiki.kent-chiu.com/doku.php?id=mysql:enabled_slow_queries" title="mysql:enabled_slow_queries">Watching Query
Executing</a></li>
<li><a href="http://net.tutsplus.com/tutorials/other/top-20-mysql-best-practices/" title="http://net.tutsplus.com/tutorials/other/top-20-mysql-best-practices/">MySQL效能優化的方式</a></li>
<li><a href="http://wiki.kent-chiu.com/doku.php?id=mysql:update_or_delete_from_subquery_result" title="mysql:update_or_delete_from_subquery_result">Update Or Delete with Subquery
reslut</a></li>
</ul>

</div>
  
  


    </article>
  
  <div class="pagination">
    
      <a class="prev" href="/blog/page/13/">&larr; Older</a>
    
    <a href="/blog/archives">Blog Archives</a>
    
    <a class="next" href="/blog/page/11/">Newer &rarr;</a>
    
  </div>
</div>
<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2013/07/15/mac-os-x-keyboard-shortcuts-for-terminal/">Mac OS X Keyboard Shortcuts for Terminal</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/07/07/python-101/">Python 101</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/05/17/my-intellij-idea-shortcut/">My IntelliJ IDEA Shortcut</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/05/12/jesper-report-font-issue/">Jesper Report, IReport 匯出成中文PDF</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/05/12/jasperreport-101/">JasperReport 101</a>
      </li>
    
  </ul>
</section>
<section>
  <h1>Category Cloud</h1>
    <span id="tag-cloud"><a href='/blog/categories/actionbar' style='font-size: 102.4%'>actionbar(1)</a> <a href='/blog/categories/android' style='font-size: 160.0%'>android(25)</a> <a href='/blog/categories/apache' style='font-size: 116.8%'>apache(7)</a> <a href='/blog/categories/bash' style='font-size: 107.2%'>bash(3)</a> <a href='/blog/categories/best-practice' style='font-size: 102.4%'>best_practice(1)</a> <a href='/blog/categories/book' style='font-size: 102.4%'>book(1)</a> <a href='/blog/categories/broadcast-receiver' style='font-size: 104.8%'>broadcast_receiver(2)</a> <a href='/blog/categories/cdi' style='font-size: 104.8%'>cdi(2)</a> <a href='/blog/categories/centos' style='font-size: 112.0%'>centos(5)</a> <a href='/blog/categories/clean-code' style='font-size: 102.4%'>clean code(1)</a> <a href='/blog/categories/command' style='font-size: 109.6%'>command(4)</a> <a href='/blog/categories/concurrency' style='font-size: 102.4%'>concurrency(1)</a> <a href='/blog/categories/database' style='font-size: 114.4%'>database(6)</a> <a href='/blog/categories/datetime' style='font-size: 102.4%'>datetime(1)</a> <a href='/blog/categories/di' style='font-size: 104.8%'>di(2)</a> <a href='/blog/categories/drawable' style='font-size: 102.4%'>drawable(1)</a> <a href='/blog/categories/ec' style='font-size: 102.4%'>ec(1)</a> <a href='/blog/categories/eclipse' style='font-size: 102.4%'>eclipse(1)</a> <a href='/blog/categories/ecshop' style='font-size: 116.8%'>ecshop(7)</a> <a href='/blog/categories/editor' style='font-size: 102.4%'>editor(1)</a> <a href='/blog/categories/emulator' style='font-size: 102.4%'>emulator(1)</a> <a href='/blog/categories/english' style='font-size: 133.6%'>english(14)</a> <a href='/blog/categories/excel' style='font-size: 104.8%'>excel(2)</a> <a href='/blog/categories/extjs' style='font-size: 104.8%'>extjs(2)</a> <a href='/blog/categories/gesture' style='font-size: 102.4%'>gesture(1)</a> <a href='/blog/categories/git' style='font-size: 109.6%'>git(4)</a> <a href='/blog/categories/git-flow' style='font-size: 102.4%'>git-flow(1)</a> <a href='/blog/categories/guava' style='font-size: 104.8%'>guava(2)</a> <a href='/blog/categories/guice' style='font-size: 102.4%'>guice(1)</a> <a href='/blog/categories/hamcrest' style='font-size: 102.4%'>hamcrest(1)</a> <a href='/blog/categories/i18n' style='font-size: 102.4%'>i18n(1)</a> <a href='/blog/categories/ide' style='font-size: 102.4%'>IDE(1)</a> <a href='/blog/categories/idea' style='font-size: 102.4%'>IDEA(1)</a> <a href='/blog/categories/injection' style='font-size: 102.4%'>injection(1)</a> <a href='/blog/categories/intent' style='font-size: 102.4%'>intent(1)</a> <a href='/blog/categories/ireport' style='font-size: 104.8%'>ireport(2)</a> <a href='/blog/categories/jasterreport' style='font-size: 104.8%'>jasterreport(2)</a> <a href='/blog/categories/java' style='font-size: 152.8%'>java(22)</a> <a href='/blog/categories/java-ee' style='font-size: 112.0%'>java_ee(5)</a> <a href='/blog/categories/jms' style='font-size: 102.4%'>jms(1)</a> <a href='/blog/categories/joda' style='font-size: 102.4%'>joda(1)</a> <a href='/blog/categories/jpa' style='font-size: 102.4%'>jpa(1)</a> <a href='/blog/categories/jquery' style='font-size: 102.4%'>jquery(1)</a> <a href='/blog/categories/jsp' style='font-size: 104.8%'>jsp(2)</a> <a href='/blog/categories/junit' style='font-size: 102.4%'>junit(1)</a> <a href='/blog/categories/jvm' style='font-size: 104.8%'>jvm(2)</a> <a href='/blog/categories/kohana' style='font-size: 102.4%'>kohana(1)</a> <a href='/blog/categories/l10n' style='font-size: 102.4%'>l10n(1)</a> <a href='/blog/categories/layout' style='font-size: 102.4%'>layout(1)</a> <a href='/blog/categories/linux' style='font-size: 126.4%'>linux(11)</a> <a href='/blog/categories/listview' style='font-size: 104.8%'>listview(2)</a> <a href='/blog/categories/logger' style='font-size: 102.4%'>logger(1)</a> <a href='/blog/categories/m2eclilpse' style='font-size: 102.4%'>m2eclilpse(1)</a> <a href='/blog/categories/mac' style='font-size: 104.8%'>mac(2)</a> <a href='/blog/categories/mat' style='font-size: 102.4%'>mat(1)</a> <a href='/blog/categories/maven' style='font-size: 112.0%'>maven(5)</a> <a href='/blog/categories/memory' style='font-size: 102.4%'>memory(1)</a> <a href='/blog/categories/menu' style='font-size: 102.4%'>menu(1)</a> <a href='/blog/categories/mindmap' style='font-size: 104.8%'>mindmap(2)</a> <a href='/blog/categories/misc' style='font-size: 102.4%'>misc(1)</a> <a href='/blog/categories/mysql' style='font-size: 116.8%'>mysql(7)</a> <a href='/blog/categories/nio' style='font-size: 102.4%'>nio(1)</a> <a href='/blog/categories/octopress' style='font-size: 102.4%'>octopress(1)</a> <a href='/blog/categories/oracle' style='font-size: 102.4%'>oracle(1)</a> <a href='/blog/categories/osgi' style='font-size: 107.2%'>osgi(3)</a> <a href='/blog/categories/pdf' style='font-size: 104.8%'>pdf(2)</a> <a href='/blog/categories/pdt' style='font-size: 112.0%'>pdt(5)</a> <a href='/blog/categories/pear' style='font-size: 104.8%'>pear(2)</a> <a href='/blog/categories/performace' style='font-size: 102.4%'>performace(1)</a> <a href='/blog/categories/pgsql' style='font-size: 102.4%'>pgsql(1)</a> <a href='/blog/categories/php' style='font-size: 114.4%'>php(6)</a> <a href='/blog/categories/play-framework' style='font-size: 102.4%'>play_framework(1)</a> <a href='/blog/categories/pm' style='font-size: 112.0%'>pm(5)</a> <a href='/blog/categories/postgresql' style='font-size: 104.8%'>postgresql(2)</a> <a href='/blog/categories/profile' style='font-size: 102.4%'>profile(1)</a> <a href='/blog/categories/programming' style='font-size: 128.8%'>programming(12)</a> <a href='/blog/categories/python' style='font-size: 102.4%'>python(1)</a> <a href='/blog/categories/re' style='font-size: 102.4%'>re(1)</a> <a href='/blog/categories/refactory' style='font-size: 102.4%'>refactory(1)</a> <a href='/blog/categories/rest' style='font-size: 104.8%'>rest(2)</a> <a href='/blog/categories/roboguice' style='font-size: 102.4%'>roboguice(1)</a> <a href='/blog/categories/sbt' style='font-size: 102.4%'>sbt(1)</a> <a href='/blog/categories/scala' style='font-size: 109.6%'>scala(4)</a> <a href='/blog/categories/security' style='font-size: 102.4%'>security(1)</a> <a href='/blog/categories/service' style='font-size: 104.8%'>service(2)</a> <a href='/blog/categories/shiro' style='font-size: 102.4%'>shiro(1)</a> <a href='/blog/categories/shortchut' style='font-size: 102.4%'>shortchut(1)</a> <a href='/blog/categories/smarty' style='font-size: 107.2%'>smarty(3)</a> <a href='/blog/categories/spring' style='font-size: 102.4%'>spring(1)</a> <a href='/blog/categories/sql' style='font-size: 102.4%'>sql(1)</a> <a href='/blog/categories/style' style='font-size: 102.4%'>style(1)</a> <a href='/blog/categories/tdd' style='font-size: 102.4%'>tdd(1)</a> <a href='/blog/categories/testing' style='font-size: 124.0%'>testing(10)</a> <a href='/blog/categories/theme' style='font-size: 102.4%'>theme(1)</a> <a href='/blog/categories/tips' style='font-size: 104.8%'>tips(2)</a> <a href='/blog/categories/ubuntu' style='font-size: 119.2%'>ubuntu(8)</a> <a href='/blog/categories/ui' style='font-size: 104.8%'>ui(2)</a> <a href='/blog/categories/vim' style='font-size: 104.8%'>vim(2)</a> <a href='/blog/categories/web' style='font-size: 104.8%'>web(2)</a> <a href='/blog/categories/windows' style='font-size: 102.4%'>windows(1)</a> <a href='/blog/categories/xampp' style='font-size: 102.4%'>xampp(1)</a> <a href='/blog/categories/xml' style='font-size: 104.8%'>xml(2)</a> </span>
</section>
<section>
  <h1>Categories</h1>
    <ul id="category-list"><li><a href='/blog/categories/actionbar'>actionbar (1)</a></li><li><a href='/blog/categories/android'>android (25)</a></li><li><a href='/blog/categories/apache'>apache (7)</a></li><li><a href='/blog/categories/bash'>bash (3)</a></li><li><a href='/blog/categories/best-practice'>best_practice (1)</a></li><li><a href='/blog/categories/book'>book (1)</a></li><li><a href='/blog/categories/broadcast-receiver'>broadcast_receiver (2)</a></li><li><a href='/blog/categories/cdi'>cdi (2)</a></li><li><a href='/blog/categories/centos'>centos (5)</a></li><li><a href='/blog/categories/clean-code'>clean code (1)</a></li><li><a href='/blog/categories/command'>command (4)</a></li><li><a href='/blog/categories/concurrency'>concurrency (1)</a></li><li><a href='/blog/categories/database'>database (6)</a></li><li><a href='/blog/categories/datetime'>datetime (1)</a></li><li><a href='/blog/categories/di'>di (2)</a></li><li><a href='/blog/categories/drawable'>drawable (1)</a></li><li><a href='/blog/categories/ec'>ec (1)</a></li><li><a href='/blog/categories/eclipse'>eclipse (1)</a></li><li><a href='/blog/categories/ecshop'>ecshop (7)</a></li><li><a href='/blog/categories/editor'>editor (1)</a></li><li><a href='/blog/categories/emulator'>emulator (1)</a></li><li><a href='/blog/categories/english'>english (14)</a></li><li><a href='/blog/categories/excel'>excel (2)</a></li><li><a href='/blog/categories/extjs'>extjs (2)</a></li><li><a href='/blog/categories/gesture'>gesture (1)</a></li><li><a href='/blog/categories/git'>git (4)</a></li><li><a href='/blog/categories/git-flow'>git-flow (1)</a></li><li><a href='/blog/categories/guava'>guava (2)</a></li><li><a href='/blog/categories/guice'>guice (1)</a></li><li><a href='/blog/categories/hamcrest'>hamcrest (1)</a></li><li><a href='/blog/categories/i18n'>i18n (1)</a></li><li><a href='/blog/categories/ide'>IDE (1)</a></li><li><a href='/blog/categories/idea'>IDEA (1)</a></li><li><a href='/blog/categories/injection'>injection (1)</a></li><li><a href='/blog/categories/intent'>intent (1)</a></li><li><a href='/blog/categories/ireport'>ireport (2)</a></li><li><a href='/blog/categories/jasterreport'>jasterreport (2)</a></li><li><a href='/blog/categories/java'>java (22)</a></li><li><a href='/blog/categories/java-ee'>java_ee (5)</a></li><li><a href='/blog/categories/jms'>jms (1)</a></li><li><a href='/blog/categories/joda'>joda (1)</a></li><li><a href='/blog/categories/jpa'>jpa (1)</a></li><li><a href='/blog/categories/jquery'>jquery (1)</a></li><li><a href='/blog/categories/jsp'>jsp (2)</a></li><li><a href='/blog/categories/junit'>junit (1)</a></li><li><a href='/blog/categories/jvm'>jvm (2)</a></li><li><a href='/blog/categories/kohana'>kohana (1)</a></li><li><a href='/blog/categories/l10n'>l10n (1)</a></li><li><a href='/blog/categories/layout'>layout (1)</a></li><li><a href='/blog/categories/linux'>linux (11)</a></li><li><a href='/blog/categories/listview'>listview (2)</a></li><li><a href='/blog/categories/logger'>logger (1)</a></li><li><a href='/blog/categories/m2eclilpse'>m2eclilpse (1)</a></li><li><a href='/blog/categories/mac'>mac (2)</a></li><li><a href='/blog/categories/mat'>mat (1)</a></li><li><a href='/blog/categories/maven'>maven (5)</a></li><li><a href='/blog/categories/memory'>memory (1)</a></li><li><a href='/blog/categories/menu'>menu (1)</a></li><li><a href='/blog/categories/mindmap'>mindmap (2)</a></li><li><a href='/blog/categories/misc'>misc (1)</a></li><li><a href='/blog/categories/mysql'>mysql (7)</a></li><li><a href='/blog/categories/nio'>nio (1)</a></li><li><a href='/blog/categories/octopress'>octopress (1)</a></li><li><a href='/blog/categories/oracle'>oracle (1)</a></li><li><a href='/blog/categories/osgi'>osgi (3)</a></li><li><a href='/blog/categories/pdf'>pdf (2)</a></li><li><a href='/blog/categories/pdt'>pdt (5)</a></li><li><a href='/blog/categories/pear'>pear (2)</a></li><li><a href='/blog/categories/performace'>performace (1)</a></li><li><a href='/blog/categories/pgsql'>pgsql (1)</a></li><li><a href='/blog/categories/php'>php (6)</a></li><li><a href='/blog/categories/play-framework'>play_framework (1)</a></li><li><a href='/blog/categories/pm'>pm (5)</a></li><li><a href='/blog/categories/postgresql'>postgresql (2)</a></li><li><a href='/blog/categories/profile'>profile (1)</a></li><li><a href='/blog/categories/programming'>programming (12)</a></li><li><a href='/blog/categories/python'>python (1)</a></li><li><a href='/blog/categories/re'>re (1)</a></li><li><a href='/blog/categories/refactory'>refactory (1)</a></li><li><a href='/blog/categories/rest'>rest (2)</a></li><li><a href='/blog/categories/roboguice'>roboguice (1)</a></li><li><a href='/blog/categories/sbt'>sbt (1)</a></li><li><a href='/blog/categories/scala'>scala (4)</a></li><li><a href='/blog/categories/security'>security (1)</a></li><li><a href='/blog/categories/service'>service (2)</a></li><li><a href='/blog/categories/shiro'>shiro (1)</a></li><li><a href='/blog/categories/shortchut'>shortchut (1)</a></li><li><a href='/blog/categories/smarty'>smarty (3)</a></li><li><a href='/blog/categories/spring'>spring (1)</a></li><li><a href='/blog/categories/sql'>sql (1)</a></li><li><a href='/blog/categories/style'>style (1)</a></li><li><a href='/blog/categories/tdd'>tdd (1)</a></li><li><a href='/blog/categories/testing'>testing (10)</a></li><li><a href='/blog/categories/theme'>theme (1)</a></li><li><a href='/blog/categories/tips'>tips (2)</a></li><li><a href='/blog/categories/ubuntu'>ubuntu (8)</a></li><li><a href='/blog/categories/ui'>ui (2)</a></li><li><a href='/blog/categories/vim'>vim (2)</a></li><li><a href='/blog/categories/web'>web (2)</a></li><li><a href='/blog/categories/windows'>windows (1)</a></li><li><a href='/blog/categories/xampp'>xampp (1)</a></li><li><a href='/blog/categories/xml'>xml (2)</a></li></ul>
</section>

  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2013 - Kent -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'kentchiu';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>



<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) {return;}
  js = d.createElement(s); js.id = id; js.async = true;
  js.src = "//connect.facebook.net/en_US/all.js#appId=212934732101925&xfbml=1";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>



  <script type="text/javascript">
    (function() {
      var script = document.createElement('script'); script.type = 'text/javascript'; script.async = true;
      script.src = 'https://apis.google.com/js/plusone.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(script, s);
    })();
  </script>



  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = '//platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
