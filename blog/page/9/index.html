
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Kent's Blog</title>
  <meta name="author" content="Kent">

  
  <meta name="description" content="Version Plugin Home 檢查maven plugins是否有新版本 1
mvn versions:display-plugin-updates 檢查專案所需的libs(dependencies)是否有新版本 1
mvn versions:display-dependency- &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://blog.kent-chiu.com/blog/page/9">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="Kent's Blog" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/lib/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-39152849-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">Kent's Blog</a></h1>
  
    <h2>Kent的學習筆記</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:blog.kent-chiu.com" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2011/10/17/version_plugin/">Maven Version Plugin</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2011-10-17T00:00:00+08:00" pubdate data-updated="true">Oct 17<span>th</span>, 2011</time>
        
         | <a href="/blog/2011/10/17/version_plugin/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p><a href="http://mojo.codehaus.org/versions-maven-plugin/index.html" title="http://mojo.codehaus.org/versions-maven-plugin/index.html">Version Plugin Home</a></p>

<p>檢查maven plugins是否有新版本</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>mvn versions:display-plugin-updates</span></code></pre></td></tr></table></div></figure>


<p>檢查專案所需的libs(dependencies)是否有新版本</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>mvn versions:display-dependency-updates</span></code></pre></td></tr></table></div></figure>



</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2011/10/17/user_story/">User Story簡介</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2011-10-17T00:00:00+08:00" pubdate data-updated="true">Oct 17<span>th</span>, 2011</time>
        
         | <a href="/blog/2011/10/17/user_story/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>這邊採用<a href="http://en.wikipedia.org/wiki/Behavior_Driven_Development" title="http://en.wikipedia.org/wiki/Behavior_Driven_Development">Behavior_Driven_Development</a>所建議的User
Story格式進行撰寫，簡介可以看<a href="http://dannorth.net/whats-in-a-story" title="http://dannorth.net/whats-in-a-story">這裡</a>或者是<a href="http://c2.com/cgi/wiki?UserStoryTemplate" title="http://c2.com/cgi/wiki?UserStoryTemplate">這裡</a></p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>Title (one line describing the story)
</span><span class='line'> 
</span><span class='line'>Narrative:
</span><span class='line'>As a [role]
</span><span class='line'>I want [feature]
</span><span class='line'>So that [benefit]
</span><span class='line'> 
</span><span class='line'>Acceptance Criteria: (presented as Scenarios)
</span><span class='line'> 
</span><span class='line'>Scenario 1: Title
</span><span class='line'>Given [context] And [some more context]...
</span><span class='line'>When [event]
</span><span class='line'>Then [outcome] And [another outcome]...
</span><span class='line'> 
</span><span class='line'>Scenario 2: ...</span></code></pre></td></tr></table></div></figure>




<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>Story: Account Holder withdraws cash
</span><span class='line'> 
</span><span class='line'>As an Account Holder
</span><span class='line'>I want to withdraw cash from an ATM
</span><span class='line'>So that I can get money when the bank is closed
</span><span class='line'> 
</span><span class='line'>Scenario 1: Account has sufficient funds
</span><span class='line'>Given the account balance is \$100 And the card is valid And the machine contains enough money
</span><span class='line'>When the Account Holder requests \$20
</span><span class='line'>Then the ATM should dispense \$20 And the account balance should be \$80 And the card should be returned
</span><span class='line'> 
</span><span class='line'>Scenario 2: Account has insufficient funds
</span><span class='line'>Given the account balance is \$10 And the card is valid And the machine contains enough money
</span><span class='line'>When the Account Holder requests \$20
</span><span class='line'>Then the ATM should not dispense any money And the ATM should say there are insufficient funds And the account balance should be \$20 And the card should be returned
</span><span class='line'> 
</span><span class='line'>Scenario 3: Card has been disabled
</span><span class='line'>Given the card is disabled
</span><span class='line'>When the Account Holder requests \$20
</span><span class='line'>Then the ATM should retain the card
</span><span class='line'>And the ATM should say the card has been retained
</span><span class='line'> 
</span><span class='line'>Scenario 4: The ATM has insufficient funds
</span><span class='line'>...</span></code></pre></td></tr></table></div></figure>



</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2011/10/17/upgrade_php_to_5.3.x/">Upgrade PHP to 5.3</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2011-10-17T00:00:00+08:00" pubdate data-updated="true">Oct 17<span>th</span>, 2011</time>
        
         | <a href="/blog/2011/10/17/upgrade_php_to_5.3.x/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>wget http://download.fedora.redhat.com/pub/epel/5/i386/epel-release-5-3.noarch.rpm
</span><span class='line'>wget http://rpms.famillecollet.com/enterprise/remi-release-5.rpm
</span><span class='line'>rpm -Uvh remi-release-5*.rpm epel-release-5*.rpm
</span><span class='line'>yum --enablerepo=remi update php</span></code></pre></td></tr></table></div></figure>




<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>php -v
</span><span class='line'> 
</span><span class='line'>PHP 5.3.0 (cli) (built: Jul 19 2009 17:55:08)
</span><span class='line'>Copyright (c) 1997-2009 The PHP Group
</span><span class='line'>Zend Engine v2.3.0, Copyright (c) 1998-2009 Zend Technologies</span></code></pre></td></tr></table></div></figure>


<p>if you got dependency issue, you should also update mysql as same time
use this command</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>yum --enablerepo=remi update php mysql</span></code></pre></td></tr></table></div></figure>



</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2011/10/17/update_or_delete_from_subquery_result/">Update or Delete With Subquery Reslut</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2011-10-17T00:00:00+08:00" pubdate data-updated="true">Oct 17<span>th</span>, 2011</time>
        
         | <a href="/blog/2011/10/17/update_or_delete_from_subquery_result/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>if you try to delete a table and that table is using in subquery like
this</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>DELETE FROM table_a WHERE col_a IN (SELECT col_a FROM table_a) </span></code></pre></td></tr></table></div></figure>


<p>The syntax will cause a error says “You can&#8217;t specify target table &#8216;m&#8217;
for update in FROM clause”, error code is 1093. This is cause by MYSQL
DON&#8217;T support update table which also used in subquery.</p>

<p>The solution is using alias like this</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>DELETE FROM table_a WHERE col_a IN (SELECT col_a FROM (SELECT col_a FROM table_a) AS table_x)</span></code></pre></td></tr></table></div></figure>



</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2011/10/17/top-down_v.s_bottom-up_design/">由上而下 vs 由下至上 的設計</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2011-10-17T00:00:00+08:00" pubdate data-updated="true">Oct 17<span>th</span>, 2011</time>
        
         | <a href="/blog/2011/10/17/top-down_v.s_bottom-up_design/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>在開始IDCView專案時，因為底層的模型相對複雜，在用Prototype <a href="http://www.balsamiq.com/products/mockups" title="http://www.balsamiq.com/products/mockups">Balsamiq
Mockups</a>^<a href="#fn__1">1)</a>^軟體繪製完成後，就用<a href="http://wiki.kent-chiu.com/doku.php?id=prog:top-down_v.s_bottom-up_design" title="prog:top-down_v.s_bottom-up_design">Domain
Driven
Design</a>的方式對底層的電力設備模型進行分析。模型塑模(modeling)到可開發程度後，就<strong>很真覺</strong>的寫了一些API去操作這些模型。結果就很<strong>順理成章</strong>的採用了Bottom-Up(由下至上)的設計開發方式。</p>

<p>整個架構，為了搭配語言及現有的API^<a href="#fn__2">2)</a>^特性，並沒有使用Rich
Domain而是採POJO的設計方式，採用了4個主要的layers為<code>presentation → application → service → domain object(POJO)</code>。</p>

<p>在一段開發時間後，寫了好一堆個人認為應該相當好用的APIs(service
layer)，就打算套到servlet裡，就在這個時侯才發現，設計出來的API，在他的client
(servlet)裡，並沒有那麼好用，總是需要額外的加工，才有辦法使用這些services或者是要好幾個api
called才能完成一件事。在發現這個問題後，就改用Top-down的方式開發，事情就順利多了，而且每個設計出來的service也都剛好符合servlet的使用，並不需要太多的加工就可以有合適的service可以用，service的methods數量也大幅的減少。</p>

<p>所以，個人認為Top-down的方式比較能達到<a href="http://wiki.kent-chiu.com/doku.php?id=prog:k.i.s.s" title="prog:k.i.s.s">K.I.S.S</a>的效果，尤其是對採用<a href="http://wiki.kent-chiu.com/doku.php?id=prog:tdd" title="prog:tdd">TDD</a>開發方式的人來說，因為TDD有一個準備動作，就是列出所有待測的TODOs，然後挑一個最簡單的來實作。這樣，其實很容易造成太多用不到的API，因為，基本上這樣的設計方式，是在在設計一個完整的元件，而不是<strong>剛好夠用</strong>元件。</p>

<p>整個開發流程是：</p>

<ol>
<li>確定網頁大概會傳入/傳出那些參數</li>
<li>撰寫 servlet test cases</li>
<li>撰寫 servlet</li>
<li>決定需要的service API</li>
<li>Mock service API</li>
<li>servlet完成</li>
<li>撰寫 service test cases</li>
<li>實作 service interface</li>
<li>用DBUnit模擬db</li>
</ol>


<p>在<em>確定網頁大概會傳入/傳出那些參數</em>後，即可決定servlet的大致動作，然後就可以<em>撰寫
servlet test
cases</em>來<strong>mock</strong>參數的傳入及<strong>verify</strong>參數的傳出，然後，即可進行<em>撰寫
servlet</em>來滿足servlet test cases，但是servlet需要service來完成 business
logic，而且，因為是直接servlet裡決定service的api<strong>長相</strong>(此時要假設有一個完美的service
api可以解決掉你的問題，並為這個api取一個直覺的名字)，所以，通常比較能設計出清楚而直接的service
api，接著，用mock的方式來mock service
api的動作，一方面可以比較快速的得到一個可以動的api，另一方面可以為設計做一個較乾淨的切割。接再讓Servlet的test
cases通過測試了。</p>

<p>再來就是service
API的實作，如果實作部份跟資料庫有關，就用DBUnit來確定service會正常動作，而不是用mockup的方式了。</p>

<p>改採Top-down最大的收獲是最終的設計比較符合<a href="http://wiki.kent-chiu.com/doku.php?id=prog:k.i.s.s" title="prog:k.i.s.s">K.I.S.S</a>的原則，但元件的很多<del>不必要</del>很好用功能的功能就不見了，所以，以後，萬一、如果、可能、或許要用到時，就得再加進去了。</p>

<p>&lt;node
warn>本文並是不在說Bottom-Up的設計不可取，而是要看需求，之前在開發Framework或Component
base的程式時，反而是Bottom-Up比較適合，因為，你永遠不知道，別人會怎麼來使用你的API&lt;/note></p>

<h1>Service Design</h1>

<p>在前幾個模組的設計，對於service
layer是採用一個模組(或servlet)只有一個service的設計方式，而且每個service只有一個interface(class
file)，也只有一個相對的實作，一開始的動機為了讓模組間切割的更乾淨，但這樣做，會造成了不少重覆實作的Bad
Smell，所以，最後為了去掉這些重覆，就還是改回多個services的架構.</p>

<p>改成一個模組多個services的架構後，service的interface不但簡化了許多，而且更符合<a href="http://wiki.kent-chiu.com/doku.php?id=prog:ood_5_principles#srp" title="prog:ood_5_principles">SRP</a>，也消除了更多的重覆，更讓整體架構往更佳的方向前進，所以，去除重覆是很多最佳實踐的基石。</p>

<p>^<a href="#fnt__1">1)</a>^ 再次感謝佛心的Balsamiq送我一個lincense</p>

<p>^<a href="#fnt__2">2)</a>^ JPA</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2011/10/17/the_use_the_index_luke_study_note/">The Use Thd index,Luke 學習筆記</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2011-10-17T00:00:00+08:00" pubdate data-updated="true">Oct 17<span>th</span>, 2011</time>
        
         | <a href="/blog/2011/10/17/the_use_the_index_luke_study_note/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>這篇的內容，主要是記錄 <a href="http://use-the-index-luke.com" title="http://use-the-index-luke.com">Use the
index,Luke</a>
這本線上書籍的學習筆記。 內容大部份取自該網站。</p>

<p>關於 <a href="http://use-the-index-luke.com" title="http://use-the-index-luke.com">Use the
index,Luke</a>
這本書：這本書是以Open
Document的方式公佈在網路上，有網頁版及pdf版可以下載，
本書的內容主要描述database
index的方方面面，該書作者認為對一個開發人員來說，對於database的性能調教，只需要瞭解index就很足够了。</p>

<h2>Anatomy of an SQL Index</h2>

<h3>The Leaf Nodes</h3>

<p><img src="http://blog.kent-chiu.com/images/2011-10-17/the_use_the_index_luke_study_note_001.png" alt="the_use_the_index_luke_study_note_001.png" /></p>

<ul>
<li>大部分的database的index設計多以B-Tree結構實作</li>
<li>index本身不為database的一部分,是另外存放在table之外</li>
<li>index是在database的block或page上操作</li>
<li>index結構小且固定，易於排序或異動操作</li>
<li>一個indexed data對應到一個table row，indexed data是排序過的，但table
data本身是沒有排序過的</li>
<li>indexed data的排序不是簡單的由大到小，或由小大而，而是balanced
search tree (B-Tree)的排序結構</li>
</ul>


<h3>The Tree</h3>

<p><img src="http://blog.kent-chiu.com/images/2011-10-17/the_use_the_index_luke_study_note_002.png" alt="the_use_the_index_luke_study_note_002.png" /></p>

<ul>
<li>B-Tree的每一個node有兩個以上的值，會由小到大排列</li>
<li>B-Tree的next level的節點的最後一個值，會為上一級節點的值</li>
<li>同一個level的節點內的值也會由小到大依序排列</li>
<li>值可以是重覆的</li>
</ul>


<p><img src="http://blog.kent-chiu.com/images/2011-10-17/the_use_the_index_luke_study_note_003.png" alt="the_use_the_index_luke_study_note_003.png" /></p>

<ul>
<li>以據B-Tree，可以很快的找任一個節點</li>
<li>以要找值”57”來說，從root開始找的規則如上圖所示

<ol>
<li>root找57介於39到83之間，找出下一級(level
2)的節點的最大節為83的節點</li>
<li>找到level2的節點為
46,53,57,83，裡面已有我們要的值”57”，再依上述的規則找level3的節點</li>
<li>找到level3的節點為
55,57,57,此節點已經是葉節點(leaf)，所以，即為我們的要節點</li>
</ol>
</li>
</ul>


<p>一般數百萬的資料，tree的深度約在4\~5層，最糟的情形下，tree的深度也不應該大於7層</p>

<h3>Slow Indexes</h3>

<p>即使使用了index，search的動作還是有可能很慢，主要的原因發生在以下兩個操作</p>

<ol>
<li>Scanning a wider range than intended</li>
<li>Table access</li>
</ol>


<h5>Scanning a wider range than intended</h5>

<p>像上例中，57的使在leaf
node出現了兩次，這代表如果有需要，database會對這個兩個57的子節點做更多的比對，而這種情形，在index愈大時，愈容易發生</p>

<h5>Table access</h5>

<p>在最糟的情形下，每一個rowid可能分佈在不同的table
block，這表示database需要讀入更多的table
block才能完成操作，另句話說，如果所有的rowid分佈在同一個table
block，那麼只需讀一個table block就可以完成search</p>

<h2>The Where Clause</h2>

<h3>The Equals Operator</h3>

<p>以下以此table的schema為例</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>CREATE TABLE employees (
</span><span class='line'>   employee_id   NUMBER         NOT NULL,
</span><span class='line'>   first_name    VARCHAR2(1000) NOT NULL,
</span><span class='line'>   last_name     VARCHAR2(1000) NOT NULL,
</span><span class='line'>   date_of_birth DATE           NOT NULL,
</span><span class='line'>   phone_number  VARCHAR2(1000) NOT NULL,
</span><span class='line'>   CONSTRAINT employees_pk PRIMARY KEY (employee_id)
</span><span class='line'>);</span></code></pre></td></tr></table></div></figure>


<p>employee_id是pk，針對pk做query後得到的execution plan如下</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>SELECT first_name, last_name
</span><span class='line'>  FROM employees
</span><span class='line'> WHERE employee_id = 123
</span><span class='line'> 
</span><span class='line'> 
</span><span class='line'>-----------------------------------------------------------------
</span><span class='line'>| Id | Operation                   | Name         | Rows | Cost |
</span><span class='line'>-----------------------------------------------------------------
</span><span class='line'>|  0 | SELECT STATEMENT            |              |    1 |    2 |
</span><span class='line'>|  1 |  TABLE ACCESS BY INDEX ROWID| EMPLOYEES    |    1 |    2 |
</span><span class='line'>|* 2 |   INDEX UNIQUE SCAN         | EMPLOYEES_PK |    1 |    1 |
</span><span class='line'>-----------------------------------------------------------------
</span><span class='line'> 
</span><span class='line'>Predicate Information (IDENTIFIED BY operation id):
</span><span class='line'>---------------------------------------------------
</span><span class='line'>   2 - access("EMPLOYEE_ID"=123)</span></code></pre></td></tr></table></div></figure>


<p>由上面的結果可以看到此sql是透過速度最快的<em>INDEX UNIQUE
SCAN</em>執行，可以得到唯一的結果，然後需再透過<em>TABLE ACCESS BY INDEX
ROWID</em>取得”first_name”, “last_name”， 取”first_name”,
“last_name”是透過<a href="#the_leaf_nodes" title="database:the_use_the_index_luke_study_note">The Leaf Nodes</a>方式，所以速度很快</p>

<p>如果在EMPLOYEE_ID再加入一個sub ID時，讓employee_id,
subsidiary_id成為一個UNIQUE INDEX</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>CREATE UNIQUE INDEX employee_pk 
</span><span class='line'>    ON employees (employee_id, subsidiary_id);</span></code></pre></td></tr></table></div></figure>


<p>當where條件中，同時包含employee_id, subsidiary_id, 就會用INDEX UNIQUE
SCAN</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>SELECT first_name, last_name
</span><span class='line'>  FROM employees
</span><span class='line'> WHERE employee_id   = 123
</span><span class='line'>   AND subsidiary_id = 30;
</span><span class='line'> 
</span><span class='line'>-----------------------------------------------------------------
</span><span class='line'>| Id | Operation                   | Name         | Rows | Cost |
</span><span class='line'>-----------------------------------------------------------------
</span><span class='line'>|  0 | SELECT STATEMENT            |              |    1 |    2 |
</span><span class='line'>|  1 |  TABLE ACCESS BY INDEX ROWID| EMPLOYEES    |    1 |    2 |
</span><span class='line'>|* 2 |   INDEX UNIQUE SCAN         | EMPLOYEES_PK |    1 |    1 |
</span><span class='line'>-----------------------------------------------------------------
</span><span class='line'> 
</span><span class='line'>Predicate Information (IDENTIFIED BY operation id):
</span><span class='line'>---------------------------------------------------
</span><span class='line'>   2 - access("EMPLOYEE_ID"=123 AND "SUBSIDIARY_ID"=30)   </span></code></pre></td></tr></table></div></figure>


<p>但如果where條件中，只用到SUBSIDIARY_ID，那便會用效率不好的TABLE ACCESS
FULL (Full Table Scan)</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>SELECT first_name, last_name
</span><span class='line'>  FROM employees
</span><span class='line'> WHERE subsidiary_id = 20;
</span><span class='line'> 
</span><span class='line'>----------------------------------------------------
</span><span class='line'>| Id | Operation         | Name      | Rows | Cost |
</span><span class='line'>----------------------------------------------------
</span><span class='line'>|  0 | SELECT STATEMENT  |           |  110 |  477 |
</span><span class='line'>|* 1 |  TABLE ACCESS FULL| EMPLOYEES |  110 |  477 |
</span><span class='line'>----------------------------------------------------
</span><span class='line'> 
</span><span class='line'>Predicate Information (IDENTIFIED BY operation id):
</span><span class='line'>---------------------------------------------------
</span><span class='line'>   1 - filter("SUBSIDIARY_ID"=20)</span></code></pre></td></tr></table></div></figure>


<p>因為查詢時，是查詢以下的結構</p>

<p><img src="http://blog.kent-chiu.com/images/2011-10-17/the_use_the_index_luke_study_note_004.png" alt="the_use_the_index_luke_study_note_004.png" /></p>

<p>如果要讓查詢更有效率，可SUBSIDIARY_ID再為加上的一個的index，就會由FULL
TABLE SCAN變成INDEX RANGE SCAN</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>---------------------------------------------------------------
</span><span class='line'>| Id | Operation                   | Name       | Rows | Cost |
</span><span class='line'>---------------------------------------------------------------
</span><span class='line'>|  0 | SELECT STATEMENT            |            |  110 |   77 |
</span><span class='line'>|  1 |  TABLE ACCESS BY INDEX ROWID| EMPLOYEES  |  110 |   77 |
</span><span class='line'>|* 2 |   INDEX RANGE SCAN          | EMP_SUP_ID |  110 |    1 |
</span><span class='line'>---------------------------------------------------------------
</span><span class='line'>
</span><span class='line'>Predicate Information (identified by operation id):
</span><span class='line'>---------------------------------------------------
</span><span class='line'>   2 - access("SUBSIDIARY_ID"=20)</span></code></pre></td></tr></table></div></figure>


<h4>Execution Plan分析</h4>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>SELECT first_name, last_name, subsidiary_id, phone_number
</span><span class='line'>  FROM employees
</span><span class='line'> WHERE last_name  = 'WINAND'
</span><span class='line'>   AND subsidiary_id = 30;</span></code></pre></td></tr></table></div></figure>


<p>如果用以上條件查詢，會產出</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>-----------------------------------------------------------------
</span><span class='line'>| Id | Operation                   | Name         | Rows | Cost |
</span><span class='line'>-----------------------------------------------------------------
</span><span class='line'>|  0 | SELECT STATEMENT            |              |    1 |   30 |
</span><span class='line'>|* 1 |  TABLE ACCESS BY INDEX ROWID| EMPLOYEES    |    1 |   30 |
</span><span class='line'>|* 2 |   INDEX RANGE SCAN          | EMPLOYEES_PK |   40 |    2 |
</span><span class='line'>-----------------------------------------------------------------
</span><span class='line'> 
</span><span class='line'>Predicate Information (IDENTIFIED BY operation id):
</span><span class='line'>---------------------------------------------------
</span><span class='line'>   1 - filter("LAST_NAME"='WINAND')
</span><span class='line'>   2 - access("SUBSIDIARY_ID"=30)</span></code></pre></td></tr></table></div></figure>


<p>我們一步步解說database做了什麼事</p>

<ol>
<li>第一步是<em>INDEX RANGE SCAN</em>它的id是2，對應到”2 -
access(“SUBSIDIARY_ID”=30)“，它會在index
tree，找出第一個”SUBSIDIARY_ID”=30的leaf node，透過這個leaf
node可以找出所有相符的資料(可能會有相當多筆，此例中是40筆)</li>
<li>第二步是<em>TABLE ACCESS BY INDEX
ROWID</em>會取出ROWID相對的整個資料列(row)，有了整個資料列，便可執行filter(“LAST_NAME”=&#8217;WINAND&#8217;)的動作。</li>
</ol>


<p>在原來有index的欄位上做&#8217;UPPER&#8221;之類的function，會讓查詢變成FULL TABLE
SCAN</p>

<p>用Bind Parameters可以有以下兩個益處</p>

<ol>
<li>Security 可以避免SQL Injection</li>
<li>Performance Optimizer會重用cache住的sql statement，如果執行的sql
statement相當的相似。</li>
</ol>


<h3>Searching For Ranges</h3>

<p>SQL的查詢的操作運算子(EX:
&lt;,>,between,…)可以執行基於key的查找，而<strong>查詢欄位的順序</strong>對這類查詢的效能，會有巨大的影響。</p>

<h2>Execution Plan</h2>

<h3>Oracle Scripts</h3>

<h3>PostgreSQL Scripts</h3>

<p>要觀查PostgreSQL的Execution Plan只需要在要執行的statement前加上 EXPLAIN</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>EXPLAIN SELECT * FROM MY_TABLE</span></code></pre></td></tr></table></div></figure>


<p>如果SQL Statement中有bind parameter (\$1, \$2, …)，就必需先進行prepare</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>PREPARE stmt(int) AS SELECT $1;</span></code></pre></td></tr></table></div></figure>


<p>然後再EXPLAIN EXECUTE</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>EXPLAIN EXECUTE stmt(1);</span></code></pre></td></tr></table></div></figure>




<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'> QUERY PLAN
</span><span class='line'>------------------------------------------
</span><span class='line'> Result  (cost=0.00..0.01 rows=1 width=0)</span></code></pre></td></tr></table></div></figure>


<ul>
<li>cost
cost有兩個值，第一個是啟動所需的cost，第二個是執行後，取回全部資料所需的cost，cost是相對的值，沒有一定的單位，各種資料庫的cost有自已計算的方式</li>
<li>rows 估計的row count</li>
<li>width 預期的row width</li>
</ul>


<p>EXPLAIN可以加上ANALYZE，會得到更多的資料，但ANALYZE會真正去執行SQL
COMMAND，所以<strong>當COMMAND是INSERT，UPDAET，DELETE時要特別小心</strong></p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>EXPLAIN ANALYZE EXECUTE stmt(1);
</span><span class='line'> 
</span><span class='line'>                   QUERY PLAN
</span><span class='line'>--------------------------------------------------
</span><span class='line'> Result  (cost=0.00..0.01 rows=1 width=0)(actual time=0.002..0.002 rows=1 loops=1)
</span><span class='line'> Total runtime: 0.020 ms</span></code></pre></td></tr></table></div></figure>


<h3>SQLServer Scripts</h3>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2011/10/17/the_eight_great_spelling_rules/">The Eight Great Spelling Rules</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2011-10-17T00:00:00+08:00" pubdate data-updated="true">Oct 17<span>th</span>, 2011</time>
        
         | <a href="/blog/2011/10/17/the_eight_great_spelling_rules/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>author : Mark Pennington</p>

<p>article source :
<a href="http://ezinearticles.com/?The-Eight-Great-Spelling-Rules&amp;id=1845169" title="http://ezinearticles.com/?The-Eight-Great-Spelling-Rules&amp;id=1845169">http://ezinearticles.com/?The-Eight-Great-Spelling-Rules&amp;id=1845169</a></p>

<p>Although the American-English spelling system has evolved from many
sources, there are specific patterns that are well-worth learning. These
spelling patterns, or spelling rules, all have exceptions; however, they
are minimal. It is always efficient to memorize the rule, rather than
all of the exceptions. In baseball, batters are taught to “look for the
fastball, and adjust for the curve.” The same is true in the
American-English spelling system. The following are the key spelling
rules that work most of the time in the American-English spelling
system.</p>

<h2>The i before e Rule</h2>

<p>Usually spell i before e (believe), but spell e before i after a c
(receive) and when the letters are pronounced as a long /a/ sound
(neighbor).</p>

<h2>The Final y Rule</h2>

<p>Keep the y when adding an ending if the word ends in a vowel, then a y
(delay-delayed), or if the ending begins with an i (copy-copying).
Change the y to i when adding an ending if the word ends in a consonant,
then a y (pretty-prettiest).</p>

<h2>The Silent e Rule</h2>

<p>Drop the e (have-having) at the end of a syllable if the ending begins
with a vowel. Keep the e (close-closely) when the ending begins with a
consonant, has a soft /c/ or /g/ sound, then an “ous” or “able”
(peaceable, gorgeous), or if it ends in “ee”, “oe”, or “ye” (freedom,
shoeing, eyeing).</p>

<h2>The Double the Consonant Rule</h2>

<p>Double the consonant, when adding on an ending (permitted), if all three
of these conditions are met: 1. the last syllable has the accent (per /
mit) 2. the last syllable ends in a vowel, then a consonant (permit). 3.
the ending you add begins with a vowel (ed).</p>

<h2>The Ending &#8220;an&#8221; or &#8220;en&#8221; Rule</h2>

<p>End a word with “ance”, “ancy”, or “ant” (vacancy, arrogance) if the
root before has a hard /c/ or /g/ sound or if the root ends with “ear”
or “ure” (clearance, insurance). End a word with “ence”, “ency”, or
“ent” if the root before has a soft /c/ or /g/ sound (magnificent,
emergency), after “id” (residence), or if the root ends with “ere”
(reverence).</p>

<h2>The &#8220;able&#8221; or &#8220;ible&#8221; Rule</h2>

<p>End a word with “able” if the root before has a hard /c/ or /g/ sound
(despicable, navigable), after a complete root word (teachable), or
after a silent e (likeable). End a word with “ible” if the root has a
soft /c/ or /g/ sound (reducible, legible), after an “ss” (admissible),
or after an incomplete root word (audible).</p>

<h2>The Ending &#8220;ion&#8221; Rule</h2>

<p>Spell “sion” (illusion) for the final zyun sound or the final shun sound
(expulsion, compassion) if after an l or s. Spell “cian” (musician) for
a person and “tion” (condition) in most all other cases.</p>

<h2>The Plurals Rule</h2>

<p>Spell plural nouns with an s (dog-dogs), even those that end in y
(day-days) or those that end in a vowel, then an o (stereo-stereos).
Spell “es” after the sounds of /s/, /x/, /z/, /ch/, or /sh/ (box-boxes)
or after a consonant, then an o (potato-potatoes). Change the y to i and
add “es” when the word ends in a consonant, then a y (ferry-ferries).
Change the “fe” or “lf” ending to “ves” (knife-knives, shelf-shelves).</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2011/10/17/template_index/">這篇文章說明每個模版的功能</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2011-10-17T00:00:00+08:00" pubdate data-updated="true">Oct 17<span>th</span>, 2011</time>
        
         | <a href="/blog/2011/10/17/template_index/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>基本上，每個template的layout也不用特意去強記，因為，每一個theme里的每一個template(lib,dwt,
wherever…)，總之就是themes目錄下的所有檔案都不一樣。
所以，應該比較用心去了解的反而是將資料往smarty (templates)
pushing的那些php檔。能夠了解每個php送出的資訊，大概也就知道template的能秀出那麼東西了。</p>

<p>dwt應該是<strong>D</strong>ream<strong>W</strong>eaver
<strong>T</strong>emplate的縮寫，而lbi也是dreamweaver裡的一種格式。它可以透過一些特殊的tags達到server
side的include效果。 在dwt檔裡有許多地方都有以下兩組tags</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>&lt;!-- #BeginLibraryItem "/library/xxx.lbi" --&gt;&lt;!-- #EndLibraryItem --&gt;</span></code></pre></td></tr></table></div></figure>




<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>&lt;!-- TemplateBeginEditable name="xxx" --&gt;&lt;!-- TemplateEndEditable --&gt;  </span></code></pre></td></tr></table></div></figure>


<p>第一組tag的功能是include
lbi檔，如果tag有內容，內容應該會與被included的檔案一模一樣，這是因為<strong>某些</strong>editor(dreamweaver)自動include進來的
，但是如果<strong>直接去編輯tag內容(inner
text)是沒用的，頁面並不會相對改變</strong>，惟有直接修改lbi檔的內容，頁面才會改變。</p>

<p>第二組tag不太清楚實際的作用是什麼^<a href="#fn__1">1)</a>^可以直接拿掉，但tag內容要保留。</p>

<p>以一個簡單的例子來說明這種效果</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>&lt;b&gt;Hello World!&lt;/b&gt;</span></code></pre></td></tr></table></div></figure>




<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>&lt;!-- #BeginLibraryItem "/library/my.lbi" --&gt;
</span><span class='line'>&lt;b&gt;Hello World!&lt;/b&gt;
</span><span class='line'>&lt;!-- #EndLibraryItem --&gt;
</span><span class='line'>&lt;!-- TemplateBeginEditable name="foo" --&gt;
</span><span class='line'>&lt;b&gt;Kent&lt;/b&gt;
</span><span class='line'>&lt;!-- TemplateEndEditable --&gt;  </span></code></pre></td></tr></table></div></figure>


<p>上面的lib會被included到my.dwt內，所以輸出會像這樣：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>Hello World!Kent</span></code></pre></td></tr></table></div></figure>


<p>再來，說明一下另一個效果</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>&lt;!-- #BeginLibraryItem "/library/my.lbi" --&gt;
</span><span class='line'>&lt;b&gt;--- Hello World! ---&lt;/b&gt;
</span><span class='line'>&lt;!-- #EndLibraryItem --&gt;
</span><span class='line'>&lt;!-- TemplateBeginEditable name="foo" --&gt;
</span><span class='line'>&lt;b&gt;Kent&lt;/b&gt;
</span><span class='line'>&lt;!-- TemplateEndEditable --&gt;  </span></code></pre></td></tr></table></div></figure>


<p>my.dwt裡第2行&lt;b>Hello
World!&lt;/b>這個並不會被render，就算去修改它，也沒有用，將第二行改成
<strong>&lt;b>— Hello World! —&lt;/b></strong>，結果輸出跟之前一樣</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>Hello World!Kent</span></code></pre></td></tr></table></div></figure>


<p>但如果是去修改lbi檔的內容</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>&lt;b&gt; *** Hello World! *** &lt;/b&gt;</span></code></pre></td></tr></table></div></figure>


<p>輸出就會改變成跟lbi的內容一樣了</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>*** Hello World! *** Kent</span></code></pre></td></tr></table></div></figure>


<p>這說明了<strong>修改BeginLibraryItem /
#EndLibraryItem間的內容是沒用的</strong>，一定要去修改lbi的檔。
換句話說，其實可以對dwt檔做以下的簡化</p>

<ol>
<li>可以移除&lt;!– TemplateBeginEditable name=“xxx” –>&lt;!–
TemplateEndEditable –> 這一對tag，但tag的內文要保留</li>
<li>可以移除&lt;!– #BeginLibraryItem ”/library/xxx.lbi” –>&lt;!–
#EndLibraryItem –> tag的內文，但tag本身要保留</li>
</ol>


<p>所以，簡化後的dwt檔會像這樣</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>&lt;!-- #BeginLibraryItem "/library/my.lbi" --&gt;
</span><span class='line'>&lt;b&gt;Kent&lt;/b&gt;</span></code></pre></td></tr></table></div></figure>


<p>有些官方的template本身就是簡化過的(預設的template沒有簡化)，所以可以拿簡化過的template來測試，會比較乾淨</p>

<p>ECShop裡面模版可以透過web畫面進行調整，調整後的layout是紀錄在db，然後把調整的page(ex:index.dwt)內容給置換掉</p>

<h2>dwt 模版</h2>

<p>備註：範本檔共22個(格式：.dwt)。</p>

<p>提醒：</p>

<ol>
<li>更改範本檔裡面庫檔的內容是無效的，頁面刷新時，程式自動重新載入庫檔內容到範本檔裡(以庫檔內容為准)。</li>
<li>範本內所有id值為 ECS_ 開頭的都必須保留(和ajax相關)。</li>
<li>非庫檔內容不可放置到可編輯區域內，否則設置範本時，非庫檔內容將被覆蓋刪除。</li>
</ol>


<p>  名稱                    說明</p>

<hr />

<p>  brand.dwt               商品品牌頁
  article.dwt             文章內容頁
  article_cat.dwt        文章列表頁
  catalog.dwt             所有分類頁
  category.dwt            商品列表頁
  compare.dwt             商品比較頁
  flow.dwt                購物車和購物流程頁
  gallery.dwt             商品相冊頁
  goods.dwt               商品詳情頁
  group_buy_goods.dwt   團購商品詳情頁
  group_buy_list.dwt    團購商品列表頁
  index.dwt               首頁
  message.dwt             資訊提示頁
  pick_out.dwt           選購中心頁
  receive.dwt             收貨確認資訊頁
  respond.dwt             線上支付結果提示資訊頁
  search.dwt              商品搜尋網頁
  snatch.dwt              奪寶奇兵頁
  tag_cloud.dwt          標籤雲頁
  user_clips.dwt         用戶中心頁 （包含：歡迎頁，我的留言，我的標籤，收藏商品，缺貨登記列表，添加缺貨登記。）
  user_passport.dwt      用戶安全頁（包含：會員登錄，會員註冊，找回密碼。）
  user_transaction.dwt   用戶中心頁 （包含：個人資料，我的紅包，添加紅包，我的訂單，訂單詳情，合併訂單，訂單狀態，商品清單，費用總計，收貨人資訊，支付方式，其他資訊，會員餘額。）</p>

<h2>Library</h2>

<p>備註：庫檔共40個 (格式 .lbi)
提醒：檔案名儘量保存默認，否則在後臺管理將無法管理庫檔或不可預見錯誤。</p>

<p>  name                       description</p>

<hr />

<p>  ad_position.lbi           廣告位
  bought_goods.lbi          購買過此商品的人購買過哪些商品
  brand_goods.lbi           品牌的商品
  brands.lbi                 品牌專區
  cart.lbi                   購物車
  cat_articles.lbi          文章列表
  cat_goods.lbi             分類下的商品
  category_tree.lbi         商品分類樹
  comments.lbi               用戶評論列表 （ajax載入comments_list.lbi。）
  comments_list.lbi         使用者評論內容
  consignee.lbi              收貨地址表單
  goods_article.lbi         相關文章
  goods_attrlinked.lbi      屬性關聯的商品
  goods_fittings.lbi        相關配件
  goods_gallery.lbi         商品相冊
  goods_list.lbi            商品列表
  goods_related.lbi         相關商品
  goods_tags.lbi            商品標記
  group_buy.lbi             首頁團購商品
  help.lbi                   網店幫助
  history.lbi                商品流覽歷史
  invoice_query.lbi         發貨單查詢
  member.lbi                 會員登錄 (ajax載入member_info.lbi。)
  member_info.lbi           會員登錄表單和登錄成功以後使用者帳戶資訊
  new_articles.lbi          最新文章
  order_total.lbi           訂單費用總計
  page_footer.lbi           頁面腳部
  page_header.lbi           頁面頂部
  pages.lbi                  列表分頁
  recommend_best.lbi        精品推薦
  recommend_hot.lbi         熱賣商品
  recommend_new.lbi         新品推薦
  recommend_promotion.lbi   促銷商品
  search_form.lbi           搜索表單
  snatch.lbi                 奪寶奇兵出價表單 (必須被id=“ECS_SNATCH”包含實現ajax刷新。)
  snatch_price.lbi          奪寶奇兵最新出價列表 (必須被id=“ECS_PRICE_LIST”包含實現ajax刷新。)
  top10.lbi                  銷售排行
  ur_here.lbi               當前位置
  user_menu.lbi             使用者中心功能表
  vote.lbi                   線上調查</p>

<h3>brand.dwt (商品品牌頁)</h3>

<p><img src="http://blog.kent-chiu.com/images/2011-10-17/template_index_article.dwt.gif" alt="template_index_article.dwt.gif" /></p>

<h3>brand.dw (商品品牌頁)</h3>

<p><img src="http://blog.kent-chiu.com/images/2011-10-17/template_index_brand.dwt.gif" alt="template_index_brand.dwt.gif" /></p>

<h3>article.dw (文章內容頁)</h3>

<p><img src="http://blog.kent-chiu.com/images/2011-10-17/template_index_article.dwt.gif" alt="template_index_article.dwt.gif" /></p>

<h3>article_cat.dwt (文章列表頁)</h3>

<p><img src="http://blog.kent-chiu.com/images/2011-10-17/template_index_article_cat.dwt.gif" alt="template_index_article_cat.dwt.gif" /></p>

<h3>catalog.dw (所有分類頁)</h3>

<p><img src="http://blog.kent-chiu.com/images/2011-10-17/template_index_catalog.dwt.gif" alt="template_index_catalog.dwt.gif" /></p>

<h3>category.dwt (商品列表頁)</h3>

<p><img src="http://blog.kent-chiu.com/images/2011-10-17/template_index_category.dwt.gif" alt="template_index_category.dwt.gif" /></p>

<h3>compare.dw (商品比較頁)</h3>

<p><img src="http://blog.kent-chiu.com/images/2011-10-17/template_index_compare.dwt.gif" alt="template_index_compare.dwt.gif" /></p>

<h3>flow.dwt (購物車和購物流程頁)</h3>

<p><img src="http://blog.kent-chiu.com/images/2011-10-17/template_index_flow.dwt.gif" alt="template_index_flow.dwt.gif" /></p>

<h3>gallery.dw (商品相冊頁)</h3>

<p><img src="http://blog.kent-chiu.com/images/2011-10-17/template_index_gallery.dwt.gif" alt="template_index_gallery.dwt.gif" /></p>

<h3>goods.dw (商品詳情頁)</h3>

<p><img src="http://blog.kent-chiu.com/images/2011-10-17/template_index_goods.dwt.gif" alt="template_index_goods.dwt.gif" /></p>

<h3>group_buy_goods.dwt (團購商品詳情頁)</h3>

<p><img src="http://blog.kent-chiu.com/images/2011-10-17/template_index_group_buy_goods.dwt.gif" alt="template_index_group_buy_goods.dwt.gif" /></p>

<h3>group_buy_list.dwt (團購商品列表頁)</h3>

<p><img src="http://blog.kent-chiu.com/images/2011-10-17/template_index_group_buy_list.dwt.gif" alt="template_index_group_buy_list.dwt.gif" /></p>

<h3>index.dw (首頁)</h3>

<p>兩張圖的layout沒有完全一致，參考看看就好</p>

<p><img src="http://blog.kent-chiu.com/images/2011-10-17/template_index_index.dwt.gif" alt="template_index_index.dwt.gif" /></p>

<p><img src="http://blog.kent-chiu.com/images/2011-10-17/template_index_index.png" alt="template_index_index.png" /></p>

<h3>message.dw ( 資訊提示頁)</h3>

<p><img src="http://blog.kent-chiu.com/images/2011-10-17/template_index_message.dwt.gif" alt="template_index_message.dwt.gif" /></p>

<h3>pick_out.dwt (選購中心頁)</h3>

<p><img src="http://blog.kent-chiu.com/images/2011-10-17/template_index_pick_out.dwt.gif" alt="template_index_pick_out.dwt.gif" /></p>

<h3>receive.dw (收貨確認資訊頁)</h3>

<p><img src="http://blog.kent-chiu.com/images/2011-10-17/template_index_receive.dwt.gif" alt="template_index_receive.dwt.gif" /></p>

<h3>respond.dw (線上支付結果提示資訊頁)</h3>

<p><img src="http://blog.kent-chiu.com/images/2011-10-17/template_index_respond.dwt.gif" alt="template_index_respond.dwt.gif" /></p>

<h3>search.dwt (商品搜尋網頁)</h3>

<p><img src="http://blog.kent-chiu.com/images/2011-10-17/template_index_search.dwt.gif" alt="template_index_search.dwt.gif" /></p>

<h3>snatch.dwt (奪寶奇兵頁)</h3>

<p><img src="http://blog.kent-chiu.com/images/2011-10-17/template_index_snatch.dwt.gif" alt="template_index_snatch.dwt.gif" /></p>

<h3>tag_cloud.dwt (標籤雲頁)</h3>

<p><img src="http://blog.kent-chiu.com/images/2011-10-17/template_index_tag_cloud.dwt.gif" alt="template_index_tag_cloud.dwt.gif" /></p>

<h3>user_clips.dwt (用戶中心頁)</h3>

<p><img src="http://blog.kent-chiu.com/images/2011-10-17/template_index_user_clips.dwt.gif" alt="template_index_user_clips.dwt.gif" /></p>

<h3>user_passport.dwt (用戶安全頁)</h3>

<p><img src="http://blog.kent-chiu.com/images/2011-10-17/template_index_user_passport.dwt.gif" alt="template_index_user_passport.dwt.gif" /></p>

<h3>user_transaction.dwt (用戶中心頁)</h3>

<p><img src="http://blog.kent-chiu.com/images/2011-10-17/template_index_user_transaction.dwt.gif" alt="template_index_user_transaction.dwt.gif" /></p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2011/10/17/template/">Ec的範本機制感覺和smarty的類似，算是一個簡易的smarty把</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2011-10-17T00:00:00+08:00" pubdate data-updated="true">Oct 17<span>th</span>, 2011</time>
        
         | <a href="/blog/2011/10/17/template/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>ec的範本機制感覺和smarty的類似，算是一個簡易的smarty把</p>

<p>每個程式頁面都有如下類似的語句</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$cache_id = sprintf('%X', crc32($_SESSION['user_rank'] . '-' . $_CFG['lang']))   </span></code></pre></td></tr></table></div></figure>


<p>緩存id，現在是通過使用者等級和語言緩存不同頁面（通過這裡應該可以做網店多語種的實現）</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
<span class='line-number'>66</span>
<span class='line-number'>67</span>
<span class='line-number'>68</span>
<span class='line-number'>69</span>
<span class='line-number'>70</span>
<span class='line-number'>71</span>
<span class='line-number'>72</span>
<span class='line-number'>73</span>
<span class='line-number'>74</span>
<span class='line-number'>75</span>
<span class='line-number'>76</span>
<span class='line-number'>77</span>
<span class='line-number'>78</span>
<span class='line-number'>79</span>
<span class='line-number'>80</span>
<span class='line-number'>81</span>
<span class='line-number'>82</span>
<span class='line-number'>83</span>
<span class='line-number'>84</span>
<span class='line-number'>85</span>
<span class='line-number'>86</span>
<span class='line-number'>87</span>
<span class='line-number'>88</span>
<span class='line-number'>89</span>
<span class='line-number'>90</span>
<span class='line-number'>91</span>
<span class='line-number'>92</span>
<span class='line-number'>93</span>
<span class='line-number'>94</span>
<span class='line-number'>95</span>
<span class='line-number'>96</span>
<span class='line-number'>97</span>
<span class='line-number'>98</span>
<span class='line-number'>99</span>
<span class='line-number'>100</span>
<span class='line-number'>101</span>
<span class='line-number'>102</span>
<span class='line-number'>103</span>
<span class='line-number'>104</span>
<span class='line-number'>105</span>
<span class='line-number'>106</span>
<span class='line-number'>107</span>
<span class='line-number'>108</span>
<span class='line-number'>109</span>
<span class='line-number'>110</span>
<span class='line-number'>111</span>
<span class='line-number'>112</span>
<span class='line-number'>113</span>
<span class='line-number'>114</span>
<span class='line-number'>115</span>
<span class='line-number'>116</span>
<span class='line-number'>117</span>
<span class='line-number'>118</span>
<span class='line-number'>119</span>
<span class='line-number'>120</span>
<span class='line-number'>121</span>
<span class='line-number'>122</span>
<span class='line-number'>123</span>
<span class='line-number'>124</span>
<span class='line-number'>125</span>
<span class='line-number'>126</span>
<span class='line-number'>127</span>
<span class='line-number'>128</span>
<span class='line-number'>129</span>
<span class='line-number'>130</span>
<span class='line-number'>131</span>
<span class='line-number'>132</span>
<span class='line-number'>133</span>
<span class='line-number'>134</span>
<span class='line-number'>135</span>
<span class='line-number'>136</span>
<span class='line-number'>137</span>
<span class='line-number'>138</span>
<span class='line-number'>139</span>
<span class='line-number'>140</span>
<span class='line-number'>141</span>
<span class='line-number'>142</span>
<span class='line-number'>143</span>
<span class='line-number'>144</span>
<span class='line-number'>145</span>
<span class='line-number'>146</span>
<span class='line-number'>147</span>
<span class='line-number'>148</span>
<span class='line-number'>149</span>
<span class='line-number'>150</span>
<span class='line-number'>151</span>
<span class='line-number'>152</span>
<span class='line-number'>153</span>
<span class='line-number'>154</span>
<span class='line-number'>155</span>
<span class='line-number'>156</span>
<span class='line-number'>157</span>
<span class='line-number'>158</span>
<span class='line-number'>159</span>
<span class='line-number'>160</span>
<span class='line-number'>161</span>
<span class='line-number'>162</span>
<span class='line-number'>163</span>
<span class='line-number'>164</span>
<span class='line-number'>165</span>
<span class='line-number'>166</span>
<span class='line-number'>167</span>
<span class='line-number'>168</span>
<span class='line-number'>169</span>
<span class='line-number'>170</span>
<span class='line-number'>171</span>
<span class='line-number'>172</span>
<span class='line-number'>173</span>
<span class='line-number'>174</span>
<span class='line-number'>175</span>
<span class='line-number'>176</span>
<span class='line-number'>177</span>
<span class='line-number'>178</span>
<span class='line-number'>179</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>if (!$smarty-&gt;is_cached('index.dwt', $cache_id))
</span><span class='line'> 
</span><span class='line'>{          判斷頁面是否已經緩存，如果沒有則做變數賦值和範本裡面動態內容提取
</span><span class='line'> 
</span><span class='line'>           assign_template();  
</span><span class='line'> 
</span><span class='line'>           $smarty-&gt;assign(變數名,  變數值);
</span><span class='line'> 
</span><span class='line'>            。。。
</span><span class='line'> 
</span><span class='line'>}
</span><span class='line'> 
</span><span class='line'>$smarty-&gt;display('index.dwt', $cache_id);    顯示生成的頁面
</span><span class='line'> 
</span><span class='line'> 
</span><span class='line'> 
</span><span class='line'>頁面的範本機制都是通過cls_template.php檔實現，下面通過display函數開始進入分析，裡面只有關鍵地方的解釋，其他的可以自己去看代碼
</span><span class='line'> 
</span><span class='line'>    function display($filename, $cache_id = '')
</span><span class='line'> 
</span><span class='line'>    {
</span><span class='line'> 
</span><span class='line'>        。。。
</span><span class='line'> 
</span><span class='line'>        $out = $this-&gt;fetch($filename, $cache_id);    //這裡是處理範本的關鍵函數
</span><span class='line'> 
</span><span class='line'>        if (strpos($out, $this-&gt;_echash) !== false)     //頁面動態內容的顯示，如投票，購物車之類的，看了下面的就知道了
</span><span class='line'> 
</span><span class='line'>        {
</span><span class='line'> 
</span><span class='line'>            $k = explode($this-&gt;_echash, $out);
</span><span class='line'> 
</span><span class='line'>            foreach ($k AS $key =&gt; $val)
</span><span class='line'> 
</span><span class='line'>            {
</span><span class='line'> 
</span><span class='line'>                if (($key % 2) == 1)
</span><span class='line'> 
</span><span class='line'>                {
</span><span class='line'> 
</span><span class='line'>                    $k[$key] = $this-&gt;insert_mod($val);   //取到動態內容並賦值
</span><span class='line'> 
</span><span class='line'>                }
</span><span class='line'> 
</span><span class='line'>            }
</span><span class='line'> 
</span><span class='line'>            $out = implode('', $k);
</span><span class='line'> 
</span><span class='line'>        }
</span><span class='line'> 
</span><span class='line'>        。。。
</span><span class='line'> 
</span><span class='line'>    }
</span><span class='line'> 
</span><span class='line'> 
</span><span class='line'> 
</span><span class='line'> 
</span><span class='line'> 
</span><span class='line'>    function fetch($filename, $cache_id = '')
</span><span class='line'> 
</span><span class='line'>    {
</span><span class='line'> 
</span><span class='line'>       。。。
</span><span class='line'> 
</span><span class='line'>        if (strncmp($filename,'str:', 4) == 0)  此處處理字串範本，如郵件範本
</span><span class='line'> 
</span><span class='line'>        {
</span><span class='line'> 
</span><span class='line'>            。。。
</span><span class='line'> 
</span><span class='line'>        }
</span><span class='line'> 
</span><span class='line'>        else
</span><span class='line'> 
</span><span class='line'>        {
</span><span class='line'> 
</span><span class='line'>           。。。
</span><span class='line'> 
</span><span class='line'>            if ($this-&gt;direct_output)      
</span><span class='line'> 
</span><span class='line'>            {
</span><span class='line'> 
</span><span class='line'>               。。。
</span><span class='line'> 
</span><span class='line'>            }
</span><span class='line'> 
</span><span class='line'>            else
</span><span class='line'> 
</span><span class='line'>            {
</span><span class='line'> 
</span><span class='line'>                if ($cache_id && $this-&gt;caching)     //如果已經緩存就直接取緩存資料
</span><span class='line'> 
</span><span class='line'>                {
</span><span class='line'> 
</span><span class='line'>                    $out = $this-&gt;template_out;
</span><span class='line'> 
</span><span class='line'>                }
</span><span class='line'> 
</span><span class='line'>                else
</span><span class='line'> 
</span><span class='line'>                {
</span><span class='line'> 
</span><span class='line'>                       $out = $this-&gt;make_compiled($filename);     //編譯範本函數，關鍵函數
</span><span class='line'> 
</span><span class='line'>                    if ($cache_id)        //如果緩存id不為空則寫快取檔案
</span><span class='line'> 
</span><span class='line'>                    {
</span><span class='line'> 
</span><span class='line'>                               。。。一些緩存資料，如緩存有效期之類的
</span><span class='line'> 
</span><span class='line'>                    }
</span><span class='line'> 
</span><span class='line'>                }
</span><span class='line'> 
</span><span class='line'>            }
</span><span class='line'> 
</span><span class='line'>        }
</span><span class='line'> 
</span><span class='line'>      。。。
</span><span class='line'> 
</span><span class='line'>    }
</span><span class='line'> 
</span><span class='line'> 
</span><span class='line'> 
</span><span class='line'> 
</span><span class='line'> 
</span><span class='line'> 
</span><span class='line'> 
</span><span class='line'>    function make_compiled($filename)
</span><span class='line'> 
</span><span class='line'>    {
</span><span class='line'> 
</span><span class='line'>      。。。。這裡省略一部分都是判斷檔是否有效，是否過期，是否強制編譯之類的
</span><span class='line'> 
</span><span class='line'>        if ($this-&gt;force_compile || $filestat['mtime'] &gt; $expires)
</span><span class='line'> 
</span><span class='line'>        {
</span><span class='line'> 
</span><span class='line'>            $this-&gt;_current_file = $filename;
</span><span class='line'> 
</span><span class='line'>            $source = $this-&gt;fetch_str(file_get_contents($filename));             //關鍵地方，讀取範本檔，處理範本字串
</span><span class='line'> 
</span><span class='line'>            if (file_put_contents($name, $source, LOCK_EX) === false)      //寫入編譯以後的檔
</span><span class='line'> 
</span><span class='line'>            {
</span><span class='line'> 
</span><span class='line'>                trigger_error('can\'t write:' . $name);
</span><span class='line'> 
</span><span class='line'>            }
</span><span class='line'> 
</span><span class='line'>            $source = $this-&gt;_eval($source);
</span><span class='line'> 
</span><span class='line'>        }
</span><span class='line'> 
</span><span class='line'>        return $source;
</span><span class='line'> 
</span><span class='line'>    }
</span><span class='line'> 
</span><span class='line'> 
</span><span class='line'> 
</span><span class='line'> 
</span><span class='line'> 
</span><span class='line'> 
</span><span class='line'> 
</span><span class='line'>    function fetch_str($source)
</span><span class='line'> 
</span><span class='line'>    {
</span><span class='line'> 
</span><span class='line'>        if (!defined('ECS_ADMIN'))
</span><span class='line'> 
</span><span class='line'>        {
</span><span class='line'> 
</span><span class='line'>            $source = $this-&gt;smarty_prefilter_preCompile($source);      //預處理函數，此函數代碼檔中有詳細解釋就不囉嗦了
</span><span class='line'> 
</span><span class='line'>        }
</span><span class='line'> 
</span><span class='line'>        return preg_replace("/{([^\}\{\n]*)}/e", "\$this-&gt;select('\\1');", $source);    //匹配處理{}每個標籤
</span><span class='line'> 
</span><span class='line'>    }</span></code></pre></td></tr></table></div></figure>



</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2011/10/17/sync_checking/">Diff Code Between Web Site and SVN Repos</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2011-10-17T00:00:00+08:00" pubdate data-updated="true">Oct 17<span>th</span>, 2011</time>
        
         | <a href="/blog/2011/10/17/sync_checking/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><h1>Dependencies</h1>

<ol>
<li>diff function
(<a href="http://www.holomind.de/phpnet/diff.src.php" title="http://www.holomind.de/phpnet/diff.src.php">http://www.holomind.de/phpnet/diff.src.php</a>)</li>
<li>Subversion Client API
(<a href="http://us3.php.net/manual/en/book.svn.php" title="http://us3.php.net/manual/en/book.svn.php">http://us3.php.net/manual/en/book.svn.php</a>)</li>
</ol>


<h1>Requirement</h1>

<ul>
<li>比對所有php，lbi，dwt，html檔</li>
<li>可以以版本，時間，tag等資訊比對SVN上的code</li>
<li><p>以ecshop內建的table來顯示有差異檔名</p>

<ul>
<li>以目錄排序</li>
<li>以檔名排序</li>
<li>以修改日期排序</li>
<li>以異動行數排序</li>
</ul>
</li>
<li><p>在檔名click後可以連結到異動細節</p></li>
<li>異動細節以顯眼的方式呈現</li>
</ul>


<h1>User Stories</h1>
</div>
  
  


    </article>
  
  <div class="pagination">
    
      <a class="prev" href="/blog/page/10/">&larr; Older</a>
    
    <a href="/blog/archives">Blog Archives</a>
    
    <a class="next" href="/blog/page/8/">Newer &rarr;</a>
    
  </div>
</div>
<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2013/07/15/mac-os-x-keyboard-shortcuts-for-terminal/">Mac OS X Keyboard Shortcuts for Terminal</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/05/17/my-intellij-idea-shortcut/">My IntelliJ IDEA Shortcut</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/05/12/jesper-report-font-issue/">Jesper Report, IReport 匯出成中文PDF</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/05/12/jasperreport-101/">JasperReport 101</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/05/06/mac-tips/">Mac Tips</a>
      </li>
    
  </ul>
</section>

Included file &#8216;asides/twitter.html&#8217; not found in _includes directory



  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2013 - Kent -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'kentchiu';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>



<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) {return;}
  js = d.createElement(s); js.id = id; js.async = true;
  js.src = "//connect.facebook.net/en_US/all.js#appId=212934732101925&xfbml=1";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>



  <script type="text/javascript">
    (function() {
      var script = document.createElement('script'); script.type = 'text/javascript'; script.async = true;
      script.src = 'https://apis.google.com/js/plusone.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(script, s);
    })();
  </script>



  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = '//platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
